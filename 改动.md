// 为第三页(公司概述第一页)添加动画效果
Reveal.addEventListener('slidechanged', function(event) {
    // 检查当前是否是第三页 (公司概述第一页)
    if (event.currentSlide.querySelector('h2') && 
        event.currentSlide.querySelector('h2').textContent === '公司概述') {
        
        // 获取所有highlight-box元素
        const boxes = event.currentSlide.querySelectorAll('.highlight-box');
        
        // 设置初始状态
        gsap.set(boxes, {
            opacity: 0,
            y: 30,
            scale: 0.9
        });
        
        // 创建标题动画
        const title = event.currentSlide.querySelector('h2');
        gsap.fromTo(title, 
            {
                opacity: 0,
                y: -20
            },
            {
                opacity: 1,
                y: 0,
                duration: 0.8,
                ease: "power2.out"
            }
        );
        
        // 创建内容框动画时间线
        const tl = gsap.timeline({
            defaults: {
                duration: 0.8,
                ease: "back.out(1.2)"
            }
        });
        
        // 为每个内容框添加动画，错开时间
        boxes.forEach((box, index) => {
            tl.to(box, {
                opacity: 1,
                y: 0,
                scale: 1,
                delay: index * 0.2  // 错开每个框的动画时间
            }, index * 0.3);  // 位置参数，确保按顺序播放
            
            // 为每个框内的h3添加特殊动画
            const heading = box.querySelector('h3');
            if (heading) {
                tl.fromTo(heading, 
                    {
                        opacity: 0,
                        x: -20
                    },
                    {
                        opacity: 1,
                        x: 0,
                        duration: 0.5,
                        ease: "power1.out"
                    }, 
                    index * 0.3 + 0.2  // 位置参数，在框体动画之后
                );
            }
            
            // 为列表项添加逐个出现的动画
            const listItems = box.querySelectorAll('li');
            if (listItems.length > 0) {
                tl.fromTo(listItems, 
                    {
                        opacity: 0,
                        x: 20
                    },
                    {
                        opacity: 1,
                        x: 0,
                        stagger: 0.15,  // 每个列表项之间的延迟
                        duration: 0.5,
                        ease: "power1.out"
                    }, 
                    index * 0.3 + 0.3  // 位置参数，在标题动画之后
                );
            }
            
            // 为段落添加动画
            const paragraphs = box.querySelectorAll('p');
            if (paragraphs.length > 0) {
                tl.fromTo(paragraphs, 
                    {
                        opacity: 0,
                        y: 10
                    },
                    {
                        opacity: 1,
                        y: 0,
                        stagger: 0.15,
                        duration: 0.5,
                        ease: "power1.out"
                    }, 
                    index * 0.3 + 0.3
                );
            }
        });
        
        // 添加交互效果
        boxes.forEach(box => {
            box.addEventListener('mouseenter', () => {
                gsap.to(box, {
                    backgroundColor: 'rgba(30, 41, 59, 0.9)',
                    boxShadow: '0 8px 16px rgba(0, 0, 0, 0.2)',
                    scale: 1.02,
                    duration: 0.3
                });
            });
            
            box.addEventListener('mouseleave', () => {
                gsap.to(box, {
                    backgroundColor: 'rgba(30, 41, 59, 0.8)',
                    boxShadow: '0 4px 6px rgba(0, 0, 0, 0.1)',
                    scale: 1,
                    duration: 0.3
                });
            });
        });
    }
});


// 为第四页(公司概述第二页)添加动画效果
Reveal.addEventListener('slidechanged', function(event) {
    // 检查当前是否是第四页 (公司概述第二页 - 主营业务)
    if (event.currentSlide.querySelector('h2') && 
        event.currentSlide.querySelector('h2').textContent === '主营业务') {
        
        // 获取所有highlight-box元素
        const boxes = event.currentSlide.querySelectorAll('.highlight-box');
        const title = event.currentSlide.querySelector('h2');
        
        // 设置初始状态
        gsap.set(boxes, {
            opacity: 0,
            scale: 0.95,
            y: 20
        });
        
        // 创建标题动画 - 使用打字效果
        // 首先需要准备一个文字容器
        const originalTitle = title.textContent;
        title.textContent = '';
        title.style.display = 'inline-block';
        
        // 添加打字光标
        const cursor = document.createElement('span');
        cursor.className = 'typing-cursor';
        title.parentNode.insertBefore(cursor, title.nextSibling);
        
        // 创建打字动画
        let currentText = '';
        const typingTl = gsap.timeline();
        
        // 逐个字符添加
        for (let i = 0; i < originalTitle.length; i++) {
            typingTl.to(title, {
                duration: 0.08,  // 每个字符的打字速度
                onStart: function() {
                    currentText += originalTitle[i];
                    title.textContent = currentText;
                }
            });
        }
        
        // 让光标闪烁几秒后消失
        typingTl.to(cursor, {
            opacity: 1,
            duration: 1,
            onComplete: function() {
                // 动画完成后移除光标
                setTimeout(() => {
                    cursor.remove();
                }, 2000);
            }
        });
        
        // 创建内容框动画时间线
        const contentTl = gsap.timeline({
            defaults: {
                duration: 0.7,
                ease: "power2.out"
            }
        });
        
        // 为每个内容框添加动画，错开时间
        boxes.forEach((box, index) => {
            // 主框体动画
            contentTl.to(box, {
                opacity: 1,
                y: 0,
                scale: 1,
                delay: index * 0.1
            }, index * 0.3 + 0.8);  // 在标题动画后开始
            
            // 获取内部元素
            const heading = box.querySelector('h3');
            const paragraphs = box.querySelectorAll('p');
            const lists = box.querySelectorAll('ul');
            
            // 为标题添加特殊效果
            if (heading) {
                contentTl.fromTo(heading,
                    {
                        opacity: 0,
                        y: -15,
                        scale: 0.95
                    },
                    {
                        opacity: 1,
                        y: 0,
                        scale: 1,
                        duration: 0.5,
                        ease: "back.out(1.2)"
                    },
                    index * 0.3 + 1  // 在框体动画后
                );
            }
            
            // 段落文字动画
            if (paragraphs.length > 0) {
                contentTl.fromTo(paragraphs,
                    {
                        opacity: 0,
                        y: 15
                    },
                    {
                        opacity: 1,
                        y: 0,
                        stagger: 0.2,
                        duration: 0.5
                    },
                    index * 0.3 + 1.2
                );
            }
            
            // 列表动画 - 对于业务板块，创建更复杂的效果
            if (lists.length > 0) {
                lists.forEach((list, listIndex) => {
                    const items = list.querySelectorAll('li');
                    
                    // 为列表项添加逐个出现效果
                    contentTl.fromTo(items,
                        {
                            opacity: 0,
                            x: -20,
                            scale: 0.95
                        },
                        {
                            opacity: 1,
                            x: 0,
                            scale: 1,
                            stagger: 0.15,
                            duration: 0.6,
                            ease: "power1.out"
                        },
                        index * 0.3 + 1.3 + (listIndex * 0.2)
                    );
                    
                    // 为每个列表项中的强调文本添加闪烁效果
                    items.forEach((item, itemIndex) => {
                        const strongElements = item.querySelectorAll('strong');
                        if (strongElements.length > 0) {
                            contentTl.fromTo(strongElements,
                                {
                                    color: '#60a5fa',
                                    textShadow: 'none'
                                },
                                {
                                    color: '#60a5fa',
                                    textShadow: '0 0 8px rgba(96, 165, 250, 0.7)',
                                    duration: 0.5,
                                    repeat: 1,
                                    yoyo: true
                                },
                                index * 0.3 + 1.5 + (listIndex * 0.2) + (itemIndex * 0.15)
                            );
                        }
                    });
                });
            }
        });
        
        // 添加交互效果
        boxes.forEach(box => {
            // 鼠标悬停效果
            box.addEventListener('mouseenter', () => {
                gsap.to(box, {
                    backgroundColor: 'rgba(30, 41, 59, 0.9)',
                    boxShadow: '0 8px 16px rgba(0, 0, 0, 0.2)',
                    scale: 1.02,
                    duration: 0.3
                });
                
                // 强调文本闪光效果
                const strongElements = box.querySelectorAll('strong');
                gsap.to(strongElements, {
                    color: '#3b82f6',
                    textShadow: '0 0 8px rgba(59, 130, 246, 0.7)',
                    duration: 0.3
                });
            });
            
            // 鼠标离开效果
            box.addEventListener('mouseleave', () => {
                gsap.to(box, {
                    backgroundColor: 'rgba(30, 41, 59, 0.8)',
                    boxShadow: '0 4px 6px rgba(0, 0, 0, 0.1)',
                    scale: 1,
                    duration: 0.3
                });
                
                // 恢复强调文本效果
                const strongElements = box.querySelectorAll('strong');
                gsap.to(strongElements, {
                    color: '#60a5fa',
                    textShadow: 'none',
                    duration: 0.3
                });
            });
            
            // 点击效果
            box.addEventListener('click', () => {
                gsap.to(box, {
                    scale: 0.98,
                    duration: 0.1,
                    yoyo: true,
                    repeat: 1
                });
            });
        });
    }
});



/* 添加到演示文稿中的<style>标签内 */

/* 打字光标动画 */
.typing-cursor {
    display: inline-block;
    width: 2px;
    height: 1em;
    background-color: #fff;
    margin-left: 2px;
    vertical-align: middle;
    animation: blink 0.7s infinite;
}

@keyframes blink {
    0%, 100% { opacity: 1; }
    50% { opacity: 0; }
}

/* 内容框过渡效果 */
.highlight-box {
    transition: all 0.3s ease;
}

/* 提高强调文本的可视性 */
.highlight-box strong {
    transition: all 0.3s ease;
    padding: 0 2px;
}

/* 为列表项添加更好的过渡效果 */
.highlight-box li {
    transition: transform 0.2s ease;
}

.highlight-box li:hover {
    transform: translateX(5px);
}

/* 为第四页业务板块添加特殊高亮 */
.highlight-box h3 {
    position: relative;
    display: inline-block;
}

.highlight-box h3::after {
    content: '';
    position: absolute;
    bottom: -3px;
    left: 0;
    width: 0;
    height: 2px;
    background-color: #3b82f6;
    transition: width 0.3s ease;
}

.highlight-box:hover h3::after {
    width: 100%;
}