<!doctype html>
<html lang="zh-CN">

	<head>
		<meta charset="utf-8">

		<title>歌尔股份财务分析与成功因素</title>

		<meta name="description" content="歌尔股份财务分析与成功因素演示文稿">
		<meta name="author" content="财务分析团队">

		<meta name="apple-mobile-web-app-capable" content="yes">
		<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

		<meta name="viewport" content="width=device-width, initial-scale=1.0">

		<link rel="stylesheet" href="reveal.js-5.2.1/dist/reset.css">
		<link rel="stylesheet" href="reveal.js-5.2.1/dist/reveal.css">
		<link rel="stylesheet" href="reveal.js-5.2.1/dist/theme/night.css" id="theme">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="reveal.js-5.2.1/plugin/highlight/monokai.css">
        
        <!-- Three.js库 -->
        <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/build/three.min.js"></script>
        
        <!-- ECharts库 -->
        <script src="https://cdn.bootcdn.net/ajax/libs/echarts/5.6.0/echarts.min.js"></script>
        
        <!-- GSAP动画库及插件 -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/TextPlugin.min.js"></script>
        
        <!-- Particles.js -->
        <script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>
        
        <style>
            .threejs-container {
                width: 100%;
                height: 200px;
                opacity: 1;
                position: absolute;
                top: 0;
                left: 0;
                z-index: 1;
            }
            
            #threejs-canvas {
                width: 100%;
                height: 100%;
                display: block;
            }
            
            .threejs-loading {
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                color: #fff;
                font-size: 18px;
            }
            
            .echarts-container {
                width: 100%;
                height: 150px;
                margin: 0 auto;
                min-height: 150px; /* 修改：从200px减少到150px */
                background-color: rgba(0,0,0,0.2); /* 添加背景色以确认容器位置 */
            }
            
            /* GSAP动画容器样式 */
            .gsap-container {
                width: 100%;
                height: 400px;
                position: relative;
                overflow: hidden;
                margin-top: 40px;
            }
            
            .gsap-box {
                position: absolute;
                width: 120px;
                height: 120px;
                display: flex;
                align-items: center;
                justify-content: center;
                color: white;
                font-weight: bold;
                border-radius: 10px;
                opacity: 1; /* 从0改为1，使元素默认可见 */
            }
            
            .gsap-text {
                font-size: 3em;
                position: absolute;
                opacity: 1; /* 从0改为1，使文本默认可见 */
                color: #fff;
                width: 100%;
                text-align: center;
            }
            
            .gsap-stagger-box {
                width: 50px;
                height: 50px;
                background-color: #3498db;
                display: inline-block;
                margin: 8px;
                border-radius: 5px;
            }
            
            .gsap-timeline-element {
                width: 200px;
                height: 60px;
                position: absolute;
                left: 50%;
                transform: translateX(-50%);
                text-align: center;
                line-height: 60px;
                border-radius: 8px;
                color: white;
                opacity: 1; /* 从0改为1，使元素默认可见 */
                font-size: 26px;
            }
            
            /* 歌尔股份专用样式 */
            .financial-data {
                margin-top: 40px;
                display: flex;
                justify-content: space-around;
                flex-wrap: wrap;
                color: #fff;
            }
            
            .data-item {
                margin: 15px;
                text-align: center;
            }
            
            .data-value {
                font-size: 1.6em;
                font-weight: bold;
                color: #f39c12;
            }
            
            .comparison-up {
                color: #2ecc71;
            }
            
            .comparison-down {
                color: #e74c3c;
            }
            
            .comparison-stable {
                color: #3498db;
            }
            
            .highlight-box {
                background: rgba(30, 41, 59, 0.8);
                border-radius: 10px;
                padding: 5px; /* 修改：从10px减少到5px */
                margin: 5px 0; /* 修改：从10px减少到5px */
                box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            }
            
            .highlight-box h3 {
                font-size: 20px; /* 修改：从24px减少到20px */
                margin-bottom: 5px; /* 修改：从10px减少到5px */
                color: #e2e8f0;
            }
            
            .highlight-box p {
                font-size: 14px; /* 修改：从16px减少到14px */
                line-height: 1.2; /* 修改：从1.3减少到1.2 */
                margin-bottom: 5px; /* 修改：从8px减少到5px */
            }
            
            .highlight-box ul {
                font-size: 14px; /* 修改：从16px减少到14px */
                line-height: 1.2; /* 修改：从1.3减少到1.2 */
                margin-left: 10px; /* 修改：从15px减少到10px */
            }
            
            .highlight-box li {
                margin-bottom: 3px; /* 修改：从5px减少到3px */
            }
            
            .comparison-value {
                font-size: 1.6em; /* 从2em减小到1.6em */
                font-weight: bold;
                margin: 5px 0 !important; /* 强制覆盖可能的其他样式 */
            }
            
            .positive-value {
                color: #2ecc71;
            }
            
            .negative-value {
                color: #e74c3c;
            }

            /* 标题页样式优化 */
            .title-content {
                position: absolute;
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
                width: 100%;
                text-align: center;
                z-index: 2;
                opacity: 0;
            }
            
            .title-content h1 {
                font-size: 1.8em;
                margin-bottom: 0;
                opacity: 0;
                transform: translateY(30px);
                font-weight: 500;
            }
            
            .author-info {
                opacity: 0;
                transform: translateY(20px);
            }
            
            .author-info p {
                margin: 0;
            }
            
            .author-info small {
                font-size: 0.6em;
                opacity: 0;
            }

            .typing-cursor {
                display: inline-block;
                width: 2px;
                height: 0.8em;
                background-color: #fff;
                margin-left: 2px;
                animation: blink 0.7s infinite;
                vertical-align: middle;
            }

            /* 添加标题页垂直居中样式 */
            .reveal .slides section[data-background-gradient] {
                display: flex;
                flex-direction: column;
                justify-content: center;
                height: 100%;
            }
            
            /* 未来展望部分幻灯片底部文字样式 */
            section #industry-trend-stagger ~ p,
            section #industry-trend-stagger ~ ul,
            section #future-strategy-canvas ~ p,
            section #future-strategy-canvas ~ ul,
            section #risk-matrix-chart ~ p,
            section #risk-matrix-chart ~ ul,
            section #future-forecast-chart ~ p, 
            section #future-forecast-chart ~ ul {
                font-size: 12px !important; /* 缩小字体大小 */
                line-height: 1.1 !important; /* 减小行高 */
                margin-top: 3px !important;
                margin-bottom: 3px !important;
            }

            /* 针对列表项的额外样式 */
            section #industry-trend-stagger ~ ul li,
            section #future-strategy-canvas ~ ul li,
            section #risk-matrix-chart ~ ul li,
            section #future-forecast-chart ~ ul li {
                margin-bottom: 2px !important; /* 减少列表项之间的间距 */
            }

            /* 调整reveal.js内部元素的样式 */
            .reveal h1 {
                font-size: 1.8em;  /* 从2.2em减小到1.8em */
                margin-bottom: 0.3em;  /* 减小底部边距 */
            }

            .reveal h2 {
                font-size: 1.6em;  /* 从1.8em减小到1.6em */
                margin-bottom: 0.5em;
            }

            .reveal h3 {
                font-size: 1.3em;  /* 从1.4em减小到1.3em */
                margin-bottom: 0.7em;
            }

            .reveal p {
                margin-bottom: 20px;
            }

            /* 调整内容间距 */
            .reveal section {
                padding: 20px 0;
            }

            /* GSAP动画容器样式 */
            .gsap-container {
                width: 100%;
                height: 450px;
                position: relative;
                overflow: hidden;
                margin-top: 40px;
            }
            
            .gsap-box {
                width: 100px;
                height: 100px;
                position: absolute;
                border-radius: 8px;
            }
            
            .gsap-text {
                font-size: 3em;
                position: absolute;
                opacity: 0;
                color: #fff;
                width: 100%;
                text-align: center;
            }
            
            .gsap-stagger-box {
                width: 50px;
                height: 50px;
                background-color: #3498db;
                display: inline-block;
                margin: 8px;
                border-radius: 5px;
            }
            
            .gsap-timeline-element {
                width: 200px;
                height: 60px;
                position: absolute;
                left: 50%;
                transform: translateX(-50%);
                text-align: center;
                line-height: 60px;
                border-radius: 8px;
                color: white;
                opacity: 0;
                font-size: 26px;
            }
            
            /* --- 新增：标题页动画初始状态 --- */
            .reveal .slides section[data-background-gradient] .threejs-container,
            .reveal .slides section[data-background-gradient] .title-content h1,
            .reveal .slides section[data-background-gradient] .title-content p small {
                opacity: 1; /* 修改为1 */
                transition: none;
            }

            .reveal .slides section[data-background-gradient] .title-content h1 {
                transform: translateY(0); /* 移除初始位移 */
            }
            /* --- 结束：标题页动画初始状态 --- */

            /* --- 新增：增大目录按钮字体 --- */
            #toc-animation .gsap-timeline-element {
                width: 200px;
                height: 60px;
                position: absolute;
                left: 50%;
                transform: translateX(-50%);
                text-align: center;
                line-height: 60px;
                border-radius: 8px;
                color: white;
                opacity: 1; /* 修改为1，使其默认显示 */
                font-size: 26px;
            }
            /* --- 结束：增大目录按钮字体 --- */

            /* 调整公司概述页面的字体大小 */
            section h2 {
                font-size: 48px; /* 原来可能更大，调小一些 */
                margin-bottom: 30px;
            }

            .highlight-box {
                background: rgba(30, 41, 59, 0.8);
                border-radius: 10px;
                padding: 20px;
                margin: 15px 0;
                box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            }

            .highlight-box h3 {
                font-size: 28px; /* 原来可能是32px或更大，调小 */
                margin-bottom: 15px;
                color: #e2e8f0;
            }

            .highlight-box p {
                font-size: 20px; /* 原来可能是24px，调小 */
                line-height: 1.5;
                margin-bottom: 10px;
            }

            .highlight-box ul {
                font-size: 20px; /* 原来可能是24px，调小 */
                line-height: 1.5;
                margin-left: 20px;
            }

            .highlight-box li {
                margin-bottom: 8px;
            }

            .highlight-box strong {
                color: #60a5fa;
            }

            .slides p {
                margin-top: 20px;
            }

            /* 为图表标题和图例添加新的样式 */
            .echarts-title {
                font-size: 0.9em !important; 
            }

            .echarts-legend {
                font-size: 0.8em !important;
            }

            .echarts-label {
                font-size: 0.8em !important;
            }

            /* 添加底部大标题的样式 */
            section > h1 {
                font-size: 1.8em !important; /* 原来可能是2em或更大，调小一点 */
            }

            /* 底部文字样式 */
            section > p {
                font-size: 1em !important; /* 恢复正常字体大小 */
                margin-top: 10px;
                color: #ffffff;
                font-weight: bold; /* 加粗底部文字 */
            }

            /* 特定图表类型的高度覆盖 */
            #competitors-radar-chart {
                height: 600px !important;
                min-height: 600px !important;
                width: 100% !important;
                position: relative !important;
                margin: 0 auto !important;
            }
            
            /* 特定图表类型的高度覆盖 */
            #shareholder-structure-chart, #shareholder-concentration-chart {
                height: 350px !important;
                min-height: 350px !important;
                width: 100% !important;
                position: relative !important;
            }
            
            /* 为含有图表的页面底部文字增加额外间距 */
            .echarts-container + p {
                margin-top: 15px !important;
                padding-bottom: 10px !important;
            }
            
            /* 特定图表类型的高度覆盖 */
            #stock-price-chart, #stock-performance-chart, #valuation-indicators-chart {
                height: 350px !important;
                min-height: 350px !important;
                width: 100% !important;
                position: relative !important;
            }

            .data-comparison {
                display: flex;
                justify-content: space-around;
                margin: 10px 0; /* 从20px减少到10px */
                padding: 0 10px; /* 添加水平内边距 */
            }
            
            .comparison-item {
                text-align: center;
                padding: 0 5px; /* 添加内边距 */
                max-width: 33%; /* 确保三列平均分布 */
            }
            
            .comparison-item p {
                margin: 5px 0; /* 减小段落间距 */
            }

            /* 添加表格样式 */
            .customer-table {
                width: 100%;
                border-collapse: collapse;
                margin: 0;
                background: rgba(30, 41, 59, 0.6);
                font-size: 14px;
            }

            .customer-table th, 
            .customer-table td {
                padding: 4px 6px;
                text-align: left;
                border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            }

            .customer-table th {
                background: rgba(30, 41, 59, 0.9);
                color: #e2e8f0;
                font-weight: bold;
            }

            .customer-table td.data-value {
                font-weight: bold;
                color: #f39c12;
            }

            .strategy-note {
                font-size: 12px;
                font-style: italic;
                margin-top: 3px;
                opacity: 0.9;
            }

            /* 添加双栏布局样式 */
            .two-column-layout {
                display: flex;
                justify-content: space-between;
                align-items: flex-start;
                width: 100%;
                gap: 20px;
            }

            .column-left {
                flex: 1;
                min-width: 45%;
            }

            .column-right {
                flex: 1;
                min-width: 45%;
                padding-left: 10px;
                text-align: left;
                font-size: 18px; /* 从16px增加到18px */
            }

            .column-right h2 {
                font-size: 24px; /* 从22px增加到24px */
            }

            .column-right p {
                margin-bottom: 10px;
                font-size: 18px; /* 从16px增加到18px */
                line-height: 1.3;
            }

            .column-right ul {
                text-align: left;
                margin-left: 5px;
                padding-left: 20px;
                font-size: 17px; /* 从15px增加到17px */
                line-height: 1.3;
            }

            .column-right li {
                margin-bottom: 5px;
            }

            .column-right .highlight {
                font-weight: bold;
                color: #f39c12;
            }

            /* 调整图表容器在双栏布局中的样式 */
            .column-left .echarts-container {
                width: 100%;
                height: 350px;
                margin: 0;
            }

            /* 添加成本结构分析页面文字样式 */
            .cost-structure-text {
                font-size: 10px !important;
                line-height: 1.1 !important;
                margin-bottom: 3px !important;
            }

            .cost-structure-text ul {
                font-size: 10px !important;
                line-height: 1.1 !important;
                margin-top: 3px !important;
            }

            .cost-structure-text li {
                margin-bottom: 2px !important;
            }

            .cost-structure-text .highlight {
                font-weight: bold;
            }

            /* 添加研发投入效率页面文字样式 */
            .rd-efficiency-text {
                font-size: 10px !important; /* 从12px减小到10px */
                line-height: 1.1 !important; /* 从1.2减小到1.1 */
                margin-bottom: 3px !important; /* 从4px减小到3px */
            }

            .rd-efficiency-text ul {
                font-size: 10px !important; /* 从12px减小到10px */
                line-height: 1.1 !important; /* 从1.2减小到1.1 */
                margin-top: 3px !important; /* 从4px减小到3px */
            }

            .rd-efficiency-text li {
                margin-bottom: 2px !important; /* 从3px减小到2px */
            }

            .rd-efficiency-text .highlight {
                font-weight: bold;
            }

            /* 添加新样式：控制业绩波动与周期性页面大标题 */
            #performance-volatility-chart + h1,
            section h1.slide-bottom-title {
                font-size: 0.8em !important;
                margin-top: 5px !important;
                margin-bottom: 5px !important;
            }
            
            /* 新增动画相关样式 */
            .particles-bg {
                position: fixed;  /* 改为fixed以确保全屏覆盖 */
                width: 100%;
                height: 100%;
                top: 0;
                left: 0;
                z-index: 1;
            }
            
            .char {
                display: inline-block;
                opacity: 0;
                transform: translateY(20px);
                font-weight: 500;  /* 统一字重 */
            }
            
            .typing-cursor {
                display: inline-block;
                width: 2px;
                height: 0.8em;  /* 减小光标高度 */
                background-color: #fff;
                margin-left: 2px;
                animation: blink 0.7s infinite;
            }
            
            @keyframes blink {
                0%, 100% { opacity: 1; }
                50% { opacity: 0; }
            }
            
            .reveal .slides section[data-background-gradient] {
                background: linear-gradient(45deg, #283b95, #17b2c3);
                position: relative;
                overflow: hidden;
            }
            
            .reveal .slides section[data-background-gradient]::before {
                content: '';
                position: absolute;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: radial-gradient(circle at center, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0) 70%);
                animation: pulse 8s ease-in-out infinite;
            }
            
            @keyframes pulse {
                0%, 100% { transform: scale(1); opacity: 0.5; }
                50% { transform: scale(1.2); opacity: 0.8; }
            }

            /* 目录页样式 */
            .toc-container {
                height: 100vh;
                display: flex;
                flex-direction: column;
                justify-content: center;
                align-items: center;
                position: relative;
            }
            
            .toc-item {
                width: 300px;
                height: 60px;
                margin: 10px 0;
                background: linear-gradient(45deg, rgba(26, 115, 232, 0.8), rgba(26, 115, 232, 0.6));
                border-radius: 8px;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 1.2em;
                color: #fff;
                cursor: pointer;
                opacity: 0;
                transform: translateX(-100px);
                position: relative;
                overflow: hidden;
                transition: all 0.3s ease;
            }
            
            .toc-item:nth-child(2) { background: linear-gradient(45deg, rgba(52, 152, 219, 0.8), rgba(52, 152, 219, 0.6)); }
            .toc-item:nth-child(3) { background: linear-gradient(45deg, rgba(46, 204, 113, 0.8), rgba(46, 204, 113, 0.6)); }
            .toc-item:nth-child(4) { background: linear-gradient(45deg, rgba(230, 126, 34, 0.8), rgba(230, 126, 34, 0.6)); }
            .toc-item:nth-child(5) { background: linear-gradient(45deg, rgba(155, 89, 182, 0.8), rgba(155, 89, 182, 0.6)); }
            
            .toc-item:hover {
                transform: scale(1.05);
                box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            }
            
            .toc-item::after {
                content: '';
                position: absolute;
                top: 0;
                left: -100%;
                width: 100%;
                height: 100%;
                background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
                transition: 0.5s;
            }
            
            .toc-item:hover::after {
                left: 100%;
            }
        </style>
	</head>

	<body>

		<div class="reveal">

			<!-- 演示文稿的幻灯片容器 -->
			<div class="slides">
				<!-- 1. 标题页 -->
				<section data-background-gradient="linear-gradient(to bottom, #283b95, #17b2c3)">
                    <div id="particles-js" class="particles-bg"></div>
                    <div class="threejs-container" style="position: absolute; top: 0; left: 0; width: 100%; height: 200px;">
                        <canvas id="goel-logo-canvas"></canvas>
                        <div class="threejs-loading" id="logo-loading-text">加载中...</div>
                    </div>
                    <div class="title-content">
                        <h1 class="split-text">歌尔股份财务和成功因素分析</h1>
                    </div>
                    <div class="author-info" style="position: absolute; bottom: 30px; left: 0; width: 100%; text-align: center; z-index: 2;">
					    <p>
                            <small class="typing-text" style="font-size: 0.6em; opacity: 0;">第二组：闫杰龙、刘铭宇、谭显丞、张容馨、王康康</small>
                            <span class="typing-cursor"></span>
					    </p>
                    </div>
				</section>

				<!-- 2. 目录页 -->
				<section>
					<div class="toc-container">
                        <div class="toc-item">公司概述</div>
                        <div class="toc-item">财务指标分析</div>
                        <div class="toc-item">成功因素分析</div>
                        <div class="toc-item">财务问题分析</div>
                        <div class="toc-item">未来展望</div>
                    </div>
				</section>

				<!-- 3. 公司概述第一页 -->
				<section>
					<h2>公司概述</h2>
					<div class="highlight-box">
						<h3>歌尔股份有限公司（股票代码：002241）</h3>
						<p>全球领先的智能声学、精密光学和电子产品解决方案提供商</p>
					</div>
					<div class="highlight-box">
						<h3>市场地位</h3>
						<ul>
							<li>全球知名的消费电子精密零组件和智能产品制造商</li>
							<li>苹果公司AirPods等产品的重要供应商</li>
							<li>VR/AR领域的核心供应商之一</li>
						</ul>
					</div>
					<div class="highlight-box">
						<h3>2024年重要荣誉</h3>
						<ul>
							<li>中国电子元器件骨干企业百强榜单第4位</li>
							<li>中国电子信息竞争力百强企业第15位</li>
							<li>中国制造业民营企业500强第55位</li>
						</ul>
					</div>
				</section>

				<!-- 4. 公司概述第二页 -->
				<section>
					<h2>主营业务</h2>
					<div class="highlight-box">
						<p>公司主要服务于全球科技和消费电子行业领先客户，提供精密零组件和智能硬件的垂直整合产品解决方案。</p>
					</div>
					<div class="highlight-box">
						<h3>主要业务板块</h3>
						<ul>
							<li><strong>精密零组件业务</strong>：声学、光学、微电子、结构件等产品，包括微型扬声器/受话器、MEMS传感器、VR/MR光学器件等。</li>
							<li><strong>智能声学整机业务</strong>：TWS智能无线耳机、有线/无线耳机、智能音箱等。</li>
							<li><strong>智能硬件业务</strong>：VR虚拟现实、MR混合现实、AR增强现实、智能可穿戴、智能家用电子游戏机及配件、智能家居等。</li>
						</ul>
					</div>
					<div class="highlight-box">
						<h3>主要客户</h3>
						<p>全球科技巨头，包括苹果、Meta等领先企业</p>
					</div>
				</section>

				<!-- 5. 财务指标分析 -->
				<section>
					<section>
						<h2>财务指标分析</h2>
						<p>2014-2024年主要财务数据与趋势</p>
					</section>
                    
                    <section>
                        <h2>营业收入与净利润趋势</h2>
                        <div class="echarts-container" id="revenue-profit-chart"></div>
                        <p>2024年营收突破千亿大关，净利润同比增长144.93%</p>
                    </section>
                    
                    <section>
                        <h2>毛利率变化</h2>
                        <div class="echarts-container" id="gross-margin-chart"></div>
                        <p>2023年毛利率降至8.93%历史低点，2024年显著回升至13.60%</p>
                    </section>
                    
                    <section>
                        <h2>ROE历年变化</h2>
                        <div class="echarts-container" id="roe-chart"></div>
                        <p>2023年ROE降至3.59%历史低点，2024年回升至8.65%</p>
                    </section>
                    
                    <section>
                        <h2>客户集中度分析</h2>
                        <div class="echarts-container" id="customer-chart"></div>
                        <p>2024年前五大客户占比达88.40%，第一大客户占比43.11%</p>
                    </section>
                    
                    <section>
                        <h2>同行业竞争对手对比</h2>
                        <div style="display: flex; flex-direction: column; align-items: center;">
                            <div class="echarts-container" id="competitors-radar-chart" style="height:600px !important; width:100% !important;"></div>
                            <p style="font-size: 0.8em; color: #95a5a6; margin-top: 10px; text-align: center;">数据来源：2023年年报</p>
                        </div>
                    </section>
                    
                    <section>
                        <h2>竞争对手详细分析</h2>
                        <div class="highlight-box" style="width: 90%; margin: 20px auto; font-size: 0.8em;">
                            <h3 style="color: #3498db; margin-bottom: 10px;">主要竞争对手分析</h3>
                            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
                                <div>
                                    <h4 style="color: #f39c12;">立讯精密</h4>
                                    <ul style="font-size: 0.9em; line-height: 1.3;">
                                        <li>营收规模最大：1894.87亿元</li>
                                        <li>净利润最高：66.34亿元</li>
                                        <li>较高的市净率：3.84</li>
                                    </ul>
                                </div>
                                <div>
                                    <h4 style="color: #2ecc71;">舜宇光学</h4>
                                    <ul style="font-size: 0.9em; line-height: 1.3;">
                                        <li>最高毛利率：19.8%</li>
                                        <li>较高市盈率：36.2</li>
                                        <li>技术优势突出</li>
                                    </ul>
                                </div>
                            </div>
                            <div style="margin-top: 10px;">
                                <h4 style="color: #e74c3c;">歌尔股份竞争优势</h4>
                                <ul style="font-size: 0.9em; line-height: 1.3;">
                                    <li>VR/AR领域领先地位</li>
                                    <li>TWS耳机市场份额高</li>
                                    <li>客户资源优质（苹果、Meta等）</li>
                                    <li>研发投入持续增长</li>
                                </ul>
                            </div>
                        </div>
                    </section>
                    
                    <!-- 新增：股东结构分析页面 -->
                    <section>
                        <h2>股东结构分析</h2>
                        <div class="echarts-container" id="shareholder-structure-chart"></div>
                        <p>控股股东与实际控制人持股稳定，管理层持股比例高</p>
                        <div class="highlight-box">
                            <p>歌尔集团持股14.56%，为第一大股东</p>
                            <p>创始人姜滨、姜龙合计持股15.42%，保持实际控制地位</p>
                        </div>
                    </section>
                    
                    <!-- 新增：股权集中度分析页面 -->
                    <section>
                        <h2>股权集中度分析</h2>
                        <div class="echarts-container" id="shareholder-concentration-chart"></div>
                        <p>前十大股东合计持股约40%，股权相对集中</p>
                        <div class="highlight-box">
                            <p>员工持股计划持股1.35%，有助于核心员工利益绑定</p>
                            <p>外资持股占比3.29%，保持基本稳定</p>
                        </div>
                    </section>
                    
                    <!-- 新增：股价表现分析页面 -->
                    <section>
                        <h2>股价历年表现</h2>
                        <div class="echarts-container" id="stock-price-chart"></div>
                        <p>近十年股价呈现明显周期性波动特征</p>
                        <div class="highlight-box">
                            <p>两轮完整周期：2014-2018年及2019-2023年</p>
                            <p>历史最高点69.90元(2021年)，最低点8.10元(2018年)</p>
                        </div>
                    </section>
                    
                    <!-- 新增：股价与业绩关联分析页面 -->
                    <section>
                        <h2>股价与业绩关联分析</h2>
                        <div class="echarts-container" id="stock-performance-chart"></div>
                        <p>股价波动通常领先于业绩变化，且波动幅度更大</p>
                        <div class="highlight-box">
                            <p>2021年股价高点对应业绩高点，2018年股价低点对应业绩低谷</p>
                            <p>市值从2014年约235亿元增长至2024年约734.79亿元，增长3.1倍</p>
                        </div>
                    </section>
                    
                    <!-- 新增：盛新锂能技术分析图 -->
                    <section>
                        <h2>歌尔股份股价走势图</h2>
                        <div style="text-align: center; margin: 20px 0;">
                            <img src="dba40c6237ee3e20e95fe0f0c434f96d.png" alt="歌尔股份技术分析图" style="max-width: 90%; max-height: 70vh;">
                        </div>
                        <!-- 文字已移除 -->
                    </section>
				</section>

				<!-- 6. 成功因素分析 -->
				<section>
					<section>
						<h2>成功因素分析</h2>
						<p>歌尔股份的核心竞争优势</p>
					</section>
                    
                    <section>
                        <h2>技术创新与研发实力</h2>
                        <div class="echarts-container" id="rd-investment-bar"></div>
                        <p>2024年研发投入45.69亿元，累计申请专利34,000余项</p>
                    </section>
                    
                    <section>
                        <h2>精密制造与智能制造能力</h2>
                        <div class="gsap-container" id="manufacturing-animation">
                            <div class="gsap-box" style="background-color: #3498db; left: 20%; top: 40%;">精密制造</div>
                            <div class="gsap-box" style="background-color: #2ecc71; left: 50%; top: 40%;">智能制造</div>
                            <div class="gsap-box" style="background-color: #e74c3c; left: 80%; top: 40%;">质量管控</div>
                        </div>
                        <p>自动化生产线与精密制造工艺的完美结合</p>
                    </section>
                    
                    <section>
                        <h2>优质客户资源与战略转型</h2>
                        <div style="height: 300px; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; margin: 20px 0;">
                            <h3 style="font-size: 28px; margin-bottom: 20px; color: #3498db;">与全球顶尖科技公司建立深度合作关系</h3>
                            <ul style="text-align: left; font-size: 22px; list-style-type: none;">
                                <li style="margin-bottom: 15px;">✓ 苹果公司AirPods等产品的重要供应商</li>
                                <li style="margin-bottom: 15px;">✓ Meta公司VR/AR设备的核心合作伙伴</li>
                                <li style="margin-bottom: 15px;">✓ 国内外头部科技企业战略合作伙伴</li>
                            </ul>
                        </div>
                        <p>与全球顶尖科技公司建立深度合作关系</p>
                    </section>
                    
                    <section>
                        <h2>核心管理团队优势</h2>
                        <div style="text-align: center; margin: 20px 0;">
                            <img src="97cd036f91d0a558306f430b483ff8fc.png" alt="核心管理团队" style="max-width: 90%; max-height: 70vh;">
                        </div>
                    </section>
				</section>

				<!-- 7. 财务问题分析 -->
				<section>
					<section>
						<h2>财务问题分析</h2>
						<p>潜在风险与挑战</p>
					</section>
                    
                    <section>
                        <h2>客户集中度问题</h2>
                        <div class="echarts-container" id="customer-risk-analysis"></div>
                        <table class="customer-table">
                            <thead>
                                <tr>
                                    <th>客户</th>
                                    <th>销售额占比</th>
                                    <th>分析</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>第一大客户</td>
                                    <td class="data-value">43.11%</td>
                                    <td>存在较大的客户依赖风险</td>
                                </tr>
                                <tr>
                                    <td>第二大客户</td>
                                    <td class="data-value">27.30%</td>
                                    <td>主要客户结构保持稳定</td>
                                </tr>
                                <tr>
                                    <td>前五大客户</td>
                                    <td class="data-value">88.40%</td>
                                    <td>较2023年略有下降</td>
                                </tr>
                            </tbody>
                        </table>
                    </section>
                    
                    <section>
                        <h2>毛利率下滑分析</h2>
                        <div class="two-column-layout">
                            <div class="column-left">
                                <div class="echarts-container" id="margin-decline-analysis"></div>
                            </div>
                            <div class="column-right">
                                <p>2024年毛利率回升至13.60%，各业务板块全面提升</p>
                                <ul>
                                    <li>毛利率从2017年的<span class="highlight">23.21%</span>下降至2023年的<span class="highlight">8.93%</span>，创历史新低</li>
                                    <li>下滑主要原因：业务结构变化（低毛利率的智能硬件占比提升）、市场竞争加剧、原材料和人工成本波动</li>
                                    <li>2024年各业务板块毛利率全面提升，其中智能硬件和智能声学整机提升幅度最大</li>
                                    <li>改善措施：优化产品结构，提高高毛利率产品比例，通过智能制造和技术创新降低成本</li>
                                </ul>
                            </div>
                        </div>
                    </section>
                    
                    <section>
                        <h2>成本结构分析</h2>
                        <div class="echarts-container" id="cost-structure-pie"></div>
                        <p class="cost-structure-text">2024年直接材料占比降至85.23%，成本结构持续优化</p>
                        <ul class="cost-structure-text">
                            <li>直接材料降幅<span class="highlight">1.95%</span>，反映成本控制措施成效显著</li>
                            <li>直接人工占比<span class="highlight">5.20%</span>，同比上升0.56%</li>
                            <li>制造费用占比<span class="highlight">9.57%</span>，同比上升1.39%</li>
                            <li>智能制造推进带来的效率提升，部分抵消了人工成本上升的影响</li>
                        </ul>
                    </section>
                    
                    <section>
                        <h2>业绩波动与周期性</h2>
                        <div class="echarts-container" id="performance-volatility-chart"></div>
                        <ul style="font-size: 0.5em; line-height: 1.0; margin-top: 10px;">
                            <li>公司基本经历了两个完整的业绩周期：
                                <ul>
                                    <li>第一周期（2014-2018年）：2017年达到阶段高点，2018年显著下滑</li>
                                    <li>第二周期（2019-2023年）：2021年达到历史高点，2022-2023年连续下滑</li>
                                </ul>
                            </li>
                            <li>波动原因：消费电子产品生命周期短、主要客户产品更新周期影响、业务结构调整</li>
                            <li>应对策略：多元化布局平衡周期、保持充足现金储备、提高产线柔性化水平</li>
                        </ul>
                    </section>
                    
                    <section>
                        <h2>研发投入效率问题</h2>
                        <div class="echarts-container" id="rd-efficiency-chart"></div>
                        <p class="rd-efficiency-text">2024年研发投入45.69亿元，占营收比例4.53%</p>
                        <ul class="rd-efficiency-text">
                            <li>研发费用占营收比例从2022年的<span class="highlight">4.96%</span>下降到2023年的<span class="highlight">4.64%</span></li>
                            <li>研发投入与营收增长不同步，研发转化效率有待提高</li>
                            <li>资本化研发投入占比<span class="highlight">12.3%</span>，研发人员数量12,500余人</li>
                            <li>解决方案：加强市场导向的研发策略，聚焦重点技术领域，提高研发投入转化率</li>
                        </ul>
                    </section>
				</section>

				<!-- 7. 未来展望 -->
				<section>
					<section>
						<h2>未来展望</h2>
						<p>行业趋势与发展机遇</p>
					</section>
                    
                    <section>
                        <h2>行业发展趋势</h2>
                        <p>AI技术与硬件融合加速，元宇宙产业蓬勃发展</p>
                        <ul>
                            <li>VR/MR/AR、智能可穿戴、TWS耳机等新兴智能硬件产品市场规模持续扩大</li>
                            <li>预计2025年全球VR/AR市场规模将超过<span class="highlight">500亿美元</span></li>
                            <li>AI人工智能技术与硬件融合创造更多应用场景，尤其在空间计算和混合现实领域</li>
                            <li>随着Apple Vision Pro等新产品推出，元宇宙硬件市场迎来新机遇</li>
                            <li>汽车电子领域（智能座舱、AR-HUD等）需求旺盛，成为新增长点</li>
                        </ul>
                        <div class="gsap-container" id="industry-trend-stagger" style="display: flex; flex-wrap: wrap; justify-content: center; align-items: center;">
                            <div class="gsap-stagger-box"></div>
                            <div class="gsap-stagger-box"></div>
                            <div class="gsap-stagger-box"></div>
                            <div class="gsap-stagger-box"></div>
                            <div class="gsap-stagger-box"></div>
                            <div class="gsap-stagger-box"></div>
                            <div class="gsap-stagger-box"></div>
                            <div class="gsap-stagger-box"></div>
                            <div class="gsap-stagger-box"></div>
                        </div>
                    </section>
                    
                    <section>
                        <h2>公司发展战略</h2>
                        <div style="display: flex; flex-direction: column; align-items: center; justify-content: center; margin-top: 50px;">
                            <p style="font-size: 1.5em; margin-bottom: 30px; color: #fff;">"精密零组件+智能硬件整机"双轮驱动，强化核心技术</p>
                            <ul style="font-size: 1.2em; list-style: none; text-align: left; width: 80%;">
                                <li style="margin-bottom: 20px;">• 产品战略：重点布局高毛利率产品线，加强新兴领域产品开发</li>
                                <li style="margin-bottom: 20px;">• 技术创新：加大研发投入，保持4.5%以上的研发投入比例，强化声学、光学、微电子等核心技术</li>
                                <li style="margin-bottom: 20px;">• 市场拓展：深化与现有战略客户合作，积极开拓新客户，加强汽车电子业务布局</li>
                                <li style="margin-bottom: 20px;">• 运营提升：持续优化成本结构，提高智能制造水平，加强供应链管理</li>
                            </ul>
                        </div>
                    </section>
				</section>

				<!-- 8. 结束页 -->
				<section style="text-align: center;">
					<h1>感谢聆听、谢谢关注!</h1>
					<p>
						<small>联系我们：17658091203@163.com</small>
					</p>
				</section>
			</div>

		</div>

		<script src="reveal.js-5.2.1/dist/reveal.js"></script>
		<script src="reveal.js-5.2.1/plugin/zoom/zoom.js"></script>
		<script src="reveal.js-5.2.1/plugin/notes/notes.js"></script>
		<script src="reveal.js-5.2.1/plugin/search/search.js"></script>
		<script src="reveal.js-5.2.1/plugin/markdown/markdown.js"></script>
		<script src="reveal.js-5.2.1/plugin/highlight/highlight.js"></script>
		
		<script>
			// 初始化Reveal.js
			Reveal.initialize({
				controls: true,
				progress: true,
				center: true,
				hash: true,
				transition: 'none', // 从'slide'改为'none'
				backgroundTransition: 'none', // 从'fade'改为'none'
				plugins: [RevealMarkdown, RevealHighlight, RevealNotes]
			});
            
            // ==========Reveal.js事件处理==========
            Reveal.on('slidechanged', function(event) {
                console.log('幻灯片切换事件触发');
                const currentSlide = event.currentSlide;
                
                // 检测当前幻灯片是否包含ECharts或Three.js元素以及GSAP动画
                const hasECharts = currentSlide.querySelectorAll('.echarts-container').length > 0;
                const hasThreeJs = currentSlide.querySelectorAll('.threejs-container').length > 0;
                const hasGsap = currentSlide.querySelectorAll('.gsap-container').length > 0;
                
                console.log('检测ECharts容器:', hasECharts);
                console.log('检测Three.js容器:', hasThreeJs);
                console.log('检测GSAP容器:', hasGsap);
                
                // 重置变量
                isEChartsSlide = !!hasECharts;
                isThreeJsSlide = !!hasThreeJs;
                isGsapSlide = !!hasGsap;
                
                // 处理Three.js幻灯片
                if (isThreeJsSlide) {
                    handleThreeJsSlide(currentSlide);
                } else {
                    // 停止Three.js动画
                    isThreeJsSlide = false;
                    currentThreeJsCanvas = '';
                }
                
                // 处理ECharts幻灯片
                if (isEChartsSlide) {
                    handleEChartsSlide(currentSlide);
                    // 调整图表大小以确保完全渲染
                    window.dispatchEvent(new Event('resize'));
                } else {
                    // 重置ECharts类型
                    currentEChartsType = '';
                }
                
                // 处理GSAP动画幻灯片
                if (isGsapSlide) {
                    checkGsapSlide();
                }
                
                // 特别检查竞争对手雷达图
                if (currentSlide.querySelector('#competitors-radar-chart')) {
                    console.log('检测到竞争对手雷达图页面');
                    setTimeout(function() {
                        initCompetitorsRadarChart();
                    }, 500);
                }
            });
            
            // 幻灯片加载完成事件
            Reveal.on('ready', function(event) {
                console.log('幻灯片已就绪');
                // 获取当前幻灯片并检查各种图表
                const currentSlide = event.currentSlide;
                
                // 检测当前幻灯片是否包含ECharts或Three.js元素以及GSAP动画
                const hasECharts = currentSlide.querySelectorAll('.echarts-container').length > 0;
                const hasThreeJs = currentSlide.querySelectorAll('.threejs-container').length > 0;
                const hasGsap = currentSlide.querySelectorAll('.gsap-container').length > 0;
                
                console.log('初始检测ECharts容器:', hasECharts);
                console.log('初始检测Three.js容器:', hasThreeJs);
                console.log('初始检测GSAP容器:', hasGsap);
                
                // 设置变量
                isEChartsSlide = !!hasECharts;
                isThreeJsSlide = !!hasThreeJs;
                isGsapSlide = !!hasGsap;
                
                // 处理Three.js幻灯片
                if (isThreeJsSlide) {
                    handleThreeJsSlide(currentSlide);
                }
                
                // 处理ECharts幻灯片
                if (isEChartsSlide) {
                    handleEChartsSlide(currentSlide);
                }
                
                // 处理GSAP动画幻灯片
                if (isGsapSlide) {
                    checkGsapSlide();
                }
                
                // 调整图表大小
                window.dispatchEvent(new Event('resize'));
                
                // 初始化首页的Three.js内容
                if (currentSlide.querySelector('#goel-logo-canvas')) {
                    console.log('初始化首页Three.js内容');
                    initGoelLogo();
                }
                
                // 初始化目录页的GSAP动画
                if (currentSlide.querySelector('#toc-animation')) {
                    console.log('初始化目录页GSAP动画');
                    initGSAP('toc');
                }
            });
            
            // 处理Three.js幻灯片
            function handleThreeJsSlide(slide) {
                console.log('处理Three.js幻灯片');
                // 检查幻灯片上的内容类型
                const goeLogoCanvas = slide.querySelector('#goel-logo-canvas');
                const marketCanvas = slide.querySelector('#market-position-canvas');
                const clientCanvas = slide.querySelector('#client-relationship-canvas');
                const futureCanvas = slide.querySelector('#future-strategy-canvas');
                
                // 记录找到的canvas
                if (goeLogoCanvas) console.log('找到logo canvas');
                if (marketCanvas) console.log('找到market canvas');
                if (clientCanvas) console.log('找到client canvas');
                if (futureCanvas) console.log('找到future canvas');
                
                // 初始化不同类型的Three.js内容
                if (goeLogoCanvas) {
                    currentThreeJsCanvas = 'logo';
                    initGoelLogo();
                } else if (marketCanvas) {
                    currentThreeJsCanvas = 'market';
                    initMarketPosition();
                } else if (clientCanvas) {
                    currentThreeJsCanvas = 'client';
                    initClientRelationship();
                } else if (futureCanvas) {
                    currentThreeJsCanvas = 'future';
                    initFutureStrategy();
                }
            }
            
            // 处理ECharts幻灯片
            function handleEChartsSlide(slide) {
                // 检查幻灯片上包含的图表类型
                const hasRevenueSection = slide.querySelector('#revenue-profit-chart');
                const hasGrossMarginSection = slide.querySelector('#gross-margin-chart');
                const hasBusinessStructureSection = slide.querySelector('#business-structure-chart');
                const hasRoeSection = slide.querySelector('#roe-chart');
                const hasCustomerSection = slide.querySelector('#customer-chart');
                const hasRdSection = slide.querySelector('#rd-investment-bar');
                const hasCustomerRiskSection = slide.querySelector('#customer-risk-analysis');
                const hasMarginDeclineSection = slide.querySelector('#margin-decline-analysis');
                const hasPerformanceSection = slide.querySelector('#performance-volatility-chart');
                const hasForecastSection = slide.querySelector('#future-forecast-chart');
                // 新增的图表部分
                const hasShareholderStructureSection = slide.querySelector('#shareholder-structure-chart');
                const hasShareholderConcentrationSection = slide.querySelector('#shareholder-concentration-chart');
                const hasStockPriceSection = slide.querySelector('#stock-price-chart');
                const hasStockPerformanceSection = slide.querySelector('#stock-performance-chart');
                const hasValuationIndicatorsSection = slide.querySelector('#valuation-indicators-chart');
                const hasCostStructureSection = slide.querySelector('#cost-structure-pie');
                const hasRdEfficiencySection = slide.querySelector('#rd-efficiency-chart');
                
                console.log('检查图表容器:', {
                    'revenue-profit-chart': !!hasRevenueSection,
                    'gross-margin-chart': !!hasGrossMarginSection,
                    'business-structure-chart': !!hasBusinessStructureSection,
                    'roe-chart': !!hasRoeSection,
                    'customer-chart': !!hasCustomerSection,
                    'rd-investment-bar': !!hasRdSection,
                    'customer-risk-analysis': !!hasCustomerRiskSection,
                    'margin-decline-analysis': !!hasMarginDeclineSection,
                    'shareholder-structure-chart': !!hasShareholderStructureSection,
                    'shareholder-concentration-chart': !!hasShareholderConcentrationSection,
                    'stock-price-chart': !!hasStockPriceSection,
                    'stock-performance-chart': !!hasStockPerformanceSection,
                    'valuation-indicators-chart': !!hasValuationIndicatorsSection,
                    'cost-structure-pie': !!hasCostStructureSection,
                    'rd-efficiency-chart': !!hasRdEfficiencySection
                });
                
                // 初始化幻灯片上的所有图表，避免使用else if链，确保所有图表都能被初始化
                if (hasRevenueSection) {
                    initRevenueProfitLine();
                }
                if (hasGrossMarginSection) {
                    initGrossMarginLine();
                }
                if (hasBusinessStructureSection) {
                    console.log('初始化业务结构图表');
                    initBusinessStructurePie();
                }
                if (hasRoeSection) {
                    initRoeLine();
                }
                if (hasCustomerSection) {
                    initCustomerConcentrationBar();
                }
                if (hasRdSection) {
                    initRdInvestmentBar();
                }
                if (hasCustomerRiskSection) {
                    initCustomerRiskAnalysis();
                }
                if (hasMarginDeclineSection) {
                    initMarginDeclineAnalysis();
                }
                if (hasPerformanceSection) {
                    initPerformanceVolatility();
                }
                if (hasForecastSection) {
                    initFutureForecast();
                }
                if (hasShareholderStructureSection) {
                    initShareholderStructurePie();
                }
                if (hasShareholderConcentrationSection) {
                    initShareholderConcentrationBar();
                }
                if (hasStockPriceSection) {
                    initStockPriceLine();
                }
                if (hasStockPerformanceSection) {
                    initStockPerformanceRelation();
                }
                if (hasValuationIndicatorsSection) {
                    initValuationIndicators();
                }
                if (hasCostStructureSection) {
                    initCostStructurePie();
                }
                if (hasRdEfficiencySection) {
                    initRdEfficiencyChart();
                }
            }
            
            // 财务数据对象 - 实际数据（基于歌尔股份2024年年报）
            const goelData = {
                // 营收与利润数据（单位：亿元）- 使用MD文档中的实际数据
                revenue: {
                    years: ['2014', '2015', '2016', '2017', '2018', '2019', '2020', '2021', '2022', '2023', '2024'],
                    values: [123.00, 130.70, 190.40, 264.70, 237.80, 351.00, 577.40, 782.21, 1048.94, 985.74, 1009.54]
                },
                profit: {
                    years: ['2014', '2015', '2016', '2017', '2018', '2019', '2020', '2021', '2022', '2023', '2024'],
                    values: [16.60, 12.50, 19.00, 22.80, 6.90, 8.80, 26.10, 42.75, 17.49, 10.88, 26.65]
                },
                // 毛利率数据（百分比）
                grossMargin: {
                    years: ['2014', '2015', '2016', '2017', '2018', '2019', '2020', '2021', '2022', '2023', '2024'],
                    goel: [24.40, 21.82, 22.10, 23.21, 16.53, 15.43, 16.03, 14.13, 11.13, 8.93, 13.60],
                    // 行业数据未提供，保留原有估计值但稍作调整以保持一致性
                    industry: [23.00, 22.50, 22.00, 21.50, 21.00, 20.50, 20.00, 19.50, 19.00, 18.50, 18.00]
                },
                // 业务结构数据（2024年）
                businessStructure: [
                    {value: 15.62, name: '精密零组件'},
                    {value: 31.67, name: '智能声学整机'},
                    {value: 50.00, name: '智能硬件'}, // 确切占比未提供，估算值
                    {value: 2.71, name: '其他业务'}  // 确切占比未提供，估算值
                ],
                // ROE数据（百分比）
                roe: {
                    years: ['2014', '2015', '2016', '2017', '2018', '2019', '2020', '2021', '2022', '2023', '2024'],
                    goel: [19.89, 10.57, 11.91, 17.22, 5.07, 4.31, 14.49, 17.61, 6.17, 3.59, 8.65],
                    // 行业数据未提供，保留原有估计值但稍作调整以保持一致性
                    industry: [15.00, 14.50, 14.00, 13.50, 13.00, 12.50, 12.00, 11.50, 11.00, 10.50, 10.00]
                },
                // 客户集中度数据（2024年）
                customerConcentration: {
                    names: ['第一大客户', '第二大客户', '其他三大客户', '其他客户'],
                    values: [43.11, 27.30, 17.99, 11.60] // 根据MD文档计算：前五大88.40%，减去第一二大客户
                },
                // 研发投入数据
                rdInvestment: {
                    years: ['2019', '2020', '2021', '2022', '2023', '2024'],
                    // 2019-2021年数据未提供，使用原有估计值
                    amount: [25.00, 35.00, 45.00, 51.98, 45.73, 45.69], 
                    percentage: [7.12, 6.06, 5.75, 4.96, 4.64, 4.53]
                },
                // 客户风险分析数据
                customerRiskAnalysis: {
                    categories: ['高度依赖', '中度依赖', '低度依赖'],
                    years: ['2019', '2020', '2021', '2022', '2023', '2024'],
                    // 具体数据未提供，使用估计值但与2024年客户集中度保持一致
                    data: [
                        [60, 65, 68, 70, 70.4, 70.41], // 高度依赖（第一、二大客户合计）
                        [20, 18, 17, 16, 18.35, 17.99], // 中度依赖（其他三大客户）
                        [20, 17, 15, 14, 11.25, 11.60]  // 低度依赖（其他客户）
                    ]
                },
                // 毛利率下滑因素分析
                marginDeclineFactors: [
                    {value: 40, name: '业务结构变化'}, // 智能硬件占比提升
                    {value: 25, name: '市场竞争加剧'},
                    {value: 20, name: '原材料成本上升'},
                    {value: 10, name: '人工成本上升'},
                    {value: 5, name: '全球经济不确定性'}
                ],
                // 业绩波动分析
                performanceVolatility: {
                    years: ['2019', '2020', '2021', '2022', '2023', '2024'],
                    revenue: [100, 164.29, 222.57, 298.45, 280.44, 287.21], // 根据同比增长率计算
                    profit: [100, 296.59, 485.80, 198.75, 123.64, 302.84], // 根据同比增长率计算
                    industry: [100, 130, 150, 165, 180, 190] // 估计值
                },
                // 2025年预测数据
                forecast2025: {
                    revenue: 1200, // 根据MD文档5.3章节预计2025年营收突破1200亿
                    profit: 36, // 估计值，根据净利润率3%以上计算
                    grossMargin: 15, // 根据MD文档目标达到15%以上
                    roe: 9.5 // 估计值，基于改善趋势
                },
                // 成本构成（2024年）
                costStructure: [
                    {value: 85.23, name: '直接材料'},
                    {value: 5.20, name: '直接人工'},
                    {value: 9.57, name: '制造费用'}
                ],
                // 竞争对手对比（2023年）- 保持不变
                competitors: {
                    companies: ['歌尔股份', '立讯精密', '舜宇光学', '瑞声科技'],
                    revenue: [985.74, 1894.87, 267.45, 149.78],
                    profit: [10.88, 66.34, 15.6, 8.24],
                    grossMargin: [8.93, 13.06, 19.8, 24.9],
                    pe: [72.0, 28.5, 36.2, 18.6],
                    pb: [2.53, 3.84, 2.62, 1.23]
                },
                // 地域销售分布（2024年）
                regionDistribution: [
                    {value: 7.28, name: '境内'},
                    {value: 92.72, name: '境外'}
                ],
                // 营收与利润同比增长率
                growthRate: {
                    years: ['2018', '2019', '2020', '2021', '2022', '2023', '2024'],
                    revenue: [-10.16, 47.60, 64.29, 35.47, 34.10, -6.03, 2.41],
                    profit: [-69.74, 27.54, 122.95, 64.34, -58.42, -37.80, 144.93]
                },
                // 分业务毛利率(2024年)
                businessGrossMargin: {
                    categories: ['精密零组件', '智能声学整机', '智能硬件', '综合毛利率'],
                    values: [22.35, 11.24, 12.15, 13.60],
                    changes: [1.86, 4.50, 4.88, 4.67] // 同比变动(百分点)
                },
                // 股东结构数据（2024年底）- 更新为2024年12月31日最新数据
                shareholderStructure: {
                    names: ['歌尔集团', '姜滨', '姜龙', '香港中央结算', '中国证券金融', '员工持股计划', '其他股东'],
                    values: [14.56, 8.24, 7.18, 3.29, 2.38, 1.35, 63.00]
                },
                // 股价历年表现数据 - 保持不变，2024年数据未提供
                stockPrice: {
                    years: ['2014', '2015', '2016', '2017', '2018', '2019', '2020', '2021', '2022', '2023'],
                    yearEnd: [11.78, 27.30, 14.53, 16.92, 8.40, 20.09, 38.50, 32.21, 19.69, 22.14],
                    highest: [14.07, 37.56, 27.96, 23.21, 19.30, 21.68, 46.90, 69.90, 32.58, 28.39],
                    lowest: [8.56, 11.83, 13.80, 14.01, 8.10, 8.30, 17.10, 27.60, 15.60, 17.50],
                    changeRate: [3.79, 130.77, -46.78, 17.66, -50.30, 139.45, 92.98, -16.16, -39.00, 12.96]
                },
                // 市值变化数据（亿元）- 更新2024年数据
                marketValue: {
                    years: ['2014', '2015', '2016', '2017', '2018', '2019', '2020', '2021', '2022', '2023', '2024'],
                    values: [235, 546, 291, 338, 180, 431, 831, 697, 431, 780, 735] // 根据MD文档2.1章节，近期市值约734.79亿
                },
                // 估值指标数据 - 基于当前数据
                valuation: {
                    indicators: ['市盈率(PE)', '市净率(PB)', 'EV/EBITDA'],
                    current: [29.0, 2.53, 18.0], // 将动态市盈率更新为现实值
                    forecast: [25.0, 2.53, 15.0], // 更新为2025年预测
                    industry: [35.0, 3.20, 22.0]
                }
            };
            
            // Three.js变量
            let camera, scene, renderer;
            let logoMesh, marketMesh, clientMesh, futureMesh;
            let isThreeJsSlide = false;
            let currentThreeJsCanvas = '';
            
            // ECharts变量
            let businessPieChart, revenueProfitChart, grossMarginChart, roeChart, customerChart;
            let rdInvestmentChart, customerRiskChart, marginDeclineChart, performanceVolatilityChart, futureChart;
            let competitorsRadarChart, costStructureChart;
            let shareholderStructurePieChart, shareholderConcentrationBarChart, stockPriceLineChart;
            let stockPerformanceRelationChart, valuationIndicatorsChart;
            let currentEChartsType = '';
            
            // GSAP变量
            let isGsapSlide = false;
            let tocAnimation, manufacturingAnimation, managementTextAnimation, industryTrendAnimation;
            
            // 检查是否为Three.js幻灯片
            function checkThreeJsSlide() {
                try {
                    const currentSlide = Reveal.getCurrentSlide();
                    
                    if (currentSlide.querySelector('#goel-logo-canvas')) {
                        isThreeJsSlide = true;
                        currentThreeJsCanvas = 'logo';
                        initGoelLogo();
                    } else if (currentSlide.querySelector('#market-position-canvas')) {
                        isThreeJsSlide = true;
                        currentThreeJsCanvas = 'market';
                        initMarketPosition();
                    } else if (currentSlide.querySelector('#client-relationship-canvas')) {
                        isThreeJsSlide = true;
                        currentThreeJsCanvas = 'client';
                        initClientRelationship();
                    } else if (currentSlide.querySelector('#future-strategy-canvas')) {
                        isThreeJsSlide = true;
                        currentThreeJsCanvas = 'future';
                        initFutureStrategy();
                    } else {
                        isThreeJsSlide = false;
                        currentThreeJsCanvas = '';
                    }
                } catch (e) {
                    console.error('检查ThreeJS幻灯片时出错:', e);
                }
            }
            
            // 检查当前幻灯片是否包含ECharts图表
            function checkEChartsSlide() {
                try {
                    const currentSlide = Reveal.getCurrentSlide();
                    
                    // 重置当前图表类型
                    currentEChartsType = '';
                    
                    // 检测当前幻灯片中的图表并分别初始化
                    if (currentSlide.querySelector('#revenue-profit-chart')) {
                        console.log('检测到收入与利润走势图');
                        currentEChartsType = 'revenue-profit';
                        initECharts('revenue-profit');
                    }
                    if (currentSlide.querySelector('#gross-margin-chart')) {
                        console.log('检测到毛利率走势图');
                        currentEChartsType = 'gross-margin';
                        initECharts('gross-margin');
                    }
                    if (currentSlide.querySelector('#business-structure-chart')) {
                        console.log('检测到业务结构图');
                        currentEChartsType = 'business-structure';
                        initECharts('business-structure');
                    }
                    if (currentSlide.querySelector('#roe-chart')) {
                        console.log('检测到ROE走势图');
                        currentEChartsType = 'roe';
                        initECharts('roe');
                    }
                    if (currentSlide.querySelector('#risk-analysis-chart')) {
                        console.log('检测到风险分析图');
                        currentEChartsType = 'risk-analysis';
                        initECharts('risk-analysis');
                    }
                    if (currentSlide.querySelector('#competitors-radar-chart')) {
                        console.log('检测到竞争对手雷达图');
                        currentEChartsType = 'competitors-radar';
                        initECharts('competitors-radar');
                    }
                    if (currentSlide.querySelector('#cost-structure-pie')) {
                        console.log('检测到成本结构饼图');
                        currentEChartsType = 'cost-structure';
                        initECharts('cost-structure');
                    }
                    if (currentSlide.querySelector('#shareholder-structure-chart')) {
                        console.log('检测到股东结构饼图');
                        currentEChartsType = 'shareholder-structure';
                        initECharts('shareholder-structure');
                    }
                    if (currentSlide.querySelector('#shareholder-concentration-chart')) {
                        console.log('检测到股东集中度图');
                        currentEChartsType = 'shareholder-concentration';
                        initECharts('shareholder-concentration');
                    }
                    if (currentSlide.querySelector('#stock-price-chart')) {
                        console.log('检测到股价历年表现图');
                        currentEChartsType = 'stock-price';
                        initECharts('stock-price');
                    }
                    if (currentSlide.querySelector('#stock-performance-chart')) {
                        console.log('检测到股价与业绩关联分析图');
                        currentEChartsType = 'stock-performance';
                        initECharts('stock-performance');
                    }
                    if (currentSlide.querySelector('#valuation-indicators-chart')) {
                        console.log('检测到市场估值指标分析图');
                        currentEChartsType = 'valuation-indicators';
                        initECharts('valuation-indicators');
                    }
                    if (currentSlide.querySelector('#margin-decline-analysis')) {
                        console.log('检测到毛利率下滑因素分析图');
                        currentEChartsType = 'margin-decline';
                        initECharts('margin-decline');
                    }
                    if (currentSlide.querySelector('#rd-efficiency-chart')) {
                        console.log('检测到研发投入效率图');
                        currentEChartsType = 'rd-efficiency';
                        initECharts('rd-efficiency');
                    }
                } catch (e) {
                    console.error('检查图表时出错:', e);
                }
            }
            
            // 检查是否为GSAP动画幻灯片
            function checkGsapSlide() {
                try {
                    console.log('检查GSAP动画幻灯片');
                    const currentSlide = Reveal.getCurrentSlide();
                    
                    // 首先暂停所有GSAP动画
                    if (tocAnimation) tocAnimation.pause();
                    if (manufacturingAnimation) manufacturingAnimation.pause();
                    if (managementTextAnimation) managementTextAnimation.pause();
                    if (industryTrendAnimation) industryTrendAnimation.pause();
                    
                    if (currentSlide.querySelector('#toc-animation')) {
                        console.log('找到目录动画容器，初始化动画');
                        isGsapSlide = true;
                        initGSAP('toc');
                    } else if (currentSlide.querySelector('#manufacturing-animation')) {
                        console.log('找到制造能力动画容器，初始化动画');
                        isGsapSlide = true;
                        initGSAP('manufacturing');
                    } else if (currentSlide.querySelector('#management-text')) {
                        console.log('找到管理团队动画容器，初始化动画');
                        isGsapSlide = true;
                        initGSAP('management');
                    } else if (currentSlide.querySelector('#industry-trend-stagger')) {
                        console.log('找到行业趋势动画容器，初始化动画');
                        isGsapSlide = true;
                        initGSAP('industry-trend');
                    } else {
                        console.log('未找到GSAP动画容器');
                        isGsapSlide = false;
                    }
                } catch (e) {
                    console.error('检查GSAP幻灯片时出错:', e);
                }
            }
            
            // 调整当前图表大小
            function resizeCurrentChart() {
                try {
                    if (!currentEChartsType) return;
                    
                    console.log('调整图表大小:', currentEChartsType);
                    
                    // 根据当前图表类型调整大小
                    switch (currentEChartsType) {
                        case 'revenue-profit':
                            if (revenueProfitChart) revenueProfitChart.resize();
                            break;
                        case 'gross-margin':
                            if (grossMarginChart) grossMarginChart.resize();
                            break;
                        case 'business-structure':
                            if (businessPieChart) businessPieChart.resize();
                            break;
                        case 'roe':
                            if (roeChart) roeChart.resize();
                            break;
                        case 'risk-analysis':
                            if (riskAnalysisChart) riskAnalysisChart.resize();
                            break;
                        case 'competitors-radar':
                            if (competitorsRadarChart) competitorsRadarChart.resize();
                            break;
                        case 'cost-structure':
                            if (costStructureChart) costStructureChart.resize();
                            break;
                        case 'shareholder-structure':
                            if (shareholderStructurePieChart) shareholderStructurePieChart.resize();
                            break;
                        case 'shareholder-concentration':
                            if (shareholderConcentrationBarChart) shareholderConcentrationBarChart.resize();
                            break;
                        case 'stock-price':
                            if (stockPriceLineChart) stockPriceLineChart.resize();
                            break;
                        case 'stock-performance':
                            if (stockPerformanceRelationChart) stockPerformanceRelationChart.resize();
                            break;
                        case 'valuation-indicators':
                            if (valuationIndicatorsChart) valuationIndicatorsChart.resize();
                            break;
                        case 'margin-decline':
                            if (marginDeclineChart) marginDeclineChart.resize();
                            break;
                        case 'rd-efficiency':
                            if (rdEfficiencyChart) rdEfficiencyChart.resize();
                            break;
                        default:
                            console.warn('未知的图表类型:', currentEChartsType);
                    }
                } catch (e) {
                    console.error('调整图表大小出错:', e);
                }
            }
            
            // 修改resize事件处理函数
            window.addEventListener('resize', function() {
                // Three.js部分
                if (camera && renderer) {
                    const container = document.getElementById(currentThreeJsCanvas + '-canvas');
                    if (container) {
                        camera.aspect = container.clientWidth / container.clientHeight;
                        camera.updateProjectionMatrix();
                        renderer.setSize(container.clientWidth, container.clientHeight);
                    }
                }
                
                // ECharts部分 - 根据当前图表类型调整大小
                resizeCurrentChart();
            });
            
            // ========== Three.js 初始化函数 ==========
            
            // 初始化歌尔股份Logo (3D文字)
            function initGoelLogo() {
                const container = document.getElementById('goel-logo-canvas');
                if (!container) return;
                
                // 创建场景
                scene = new THREE.Scene();
                scene.background = new THREE.Color(0x1a1a1a);
                
                // 创建相机
                camera = new THREE.PerspectiveCamera(75, container.clientWidth / container.clientHeight, 0.1, 1000);
                camera.position.z = 5;
                
                // 创建渲染器
                renderer = new THREE.WebGLRenderer({
                    canvas: container,
                    antialias: true
                });
                renderer.setSize(container.clientWidth, container.clientHeight);
                
                // 添加灯光
                const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
                scene.add(ambientLight);
                
                const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
                directionalLight.position.set(1, 1, 1);
                scene.add(directionalLight);
                
                // 创建文字
                const loader = new THREE.FontLoader();
                // 使用系统默认字体（由于加载自定义字体可能受限）
                createTextMesh("歌尔股份", 0x1a73e8);
                
                // 隐藏加载文本
                document.getElementById('logo-loading-text').style.display = 'none';
                
                // 开始动画
                animateThreeJs();
            }
            
            // 创建3D文字网格
            function createTextMesh(text, color) {
                // 创建一个临时的立方体代替文字
                const geometry = new THREE.BoxGeometry(4, 1, 0.5);
                const materials = new THREE.MeshPhongMaterial({ 
                    color: color,
                    specular: 0x555555,
                    shininess: 30
                });
                logoMesh = new THREE.Mesh(geometry, materials);
                scene.add(logoMesh);
                
                // 添加简单的公司标识
                const sphereGeometry = new THREE.SphereGeometry(0.3, 32, 32);
                const sphereMaterial = new THREE.MeshPhongMaterial({ color: 0x3498db });
                const sphere = new THREE.Mesh(sphereGeometry, sphereMaterial);
                sphere.position.set(-1.5, 0, 0.5);
                scene.add(sphere);
            }
            
            // 初始化市场地位3D模型
            function initMarketPosition() {
                const container = document.getElementById('market-position-canvas');
                if (!container) return;
                
                // 基本场景设置与Logo相似，但模型不同
                scene = new THREE.Scene();
                scene.background = new THREE.Color(0x1a1a1a);
                
                camera = new THREE.PerspectiveCamera(75, container.clientWidth / container.clientHeight, 0.1, 1000);
                camera.position.z = 5;
                
                renderer = new THREE.WebGLRenderer({
                    canvas: container,
                    antialias: true
                });
                renderer.setSize(container.clientWidth, container.clientHeight);
                
                // 添加灯光
                const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
                scene.add(ambientLight);
                
                const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
                directionalLight.position.set(1, 1, 1);
                scene.add(directionalLight);
                
                // 创建市场地位可视化 - 使用柱状图形式
                createMarketPositionVisualization();
                
                // 隐藏加载文本
                document.getElementById('market-loading-text').style.display = 'none';
                
                // 开始动画
                animateThreeJs();
            }
            
            // 创建市场地位可视化
            function createMarketPositionVisualization() {
                const marketData = [
                    { name: "VR/AR", height: 2.0, color: 0x3498db },
                    { name: "TWS耳机", height: 1.8, color: 0x2ecc71 },
                    { name: "智能穿戴", height: 1.5, color: 0xe74c3c },
                    { name: "其他", height: 1.0, color: 0xf39c12 }
                ];
                
                const group = new THREE.Group();
                
                // 创建柱状体
                let xPos = -3;
                const spacing = 2;
                
                marketData.forEach(item => {
                    const geometry = new THREE.BoxGeometry(1, item.height, 1);
                    const material = new THREE.MeshPhongMaterial({ color: item.color });
                    const bar = new THREE.Mesh(geometry, material);
                    bar.position.set(xPos, item.height/2 - 1, 0);
                    group.add(bar);
                    xPos += spacing;
                });
                
                marketMesh = group;
                scene.add(marketMesh);
            }
            
            // 初始化客户关系3D模型
            function initClientRelationship() {
                const container = document.getElementById('client-relationship-canvas');
                if (!container) return;
                
                // 基本场景设置
                scene = new THREE.Scene();
                scene.background = new THREE.Color(0x1a1a1a);
                
                camera = new THREE.PerspectiveCamera(75, container.clientWidth / container.clientHeight, 0.1, 1000);
                camera.position.z = 5;
                
                renderer = new THREE.WebGLRenderer({
                    canvas: container,
                    antialias: true
                });
                renderer.setSize(container.clientWidth, container.clientHeight);
                
                // 添加灯光
                const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
                scene.add(ambientLight);
                
                const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
                directionalLight.position.set(1, 1, 1);
                scene.add(directionalLight);
                
                // 创建客户关系网络可视化
                createClientRelationshipVisualization();
                
                // 隐藏加载文本
                document.getElementById('client-loading-text').style.display = 'none';
                
                // 开始动画
                animateThreeJs();
            }
            
            // 创建客户关系网络可视化
            function createClientRelationshipVisualization() {
                // 创建中心节点（歌尔股份）
                const centerGeometry = new THREE.SphereGeometry(0.8, 32, 32);
                const centerMaterial = new THREE.MeshPhongMaterial({ color: 0x3498db });
                const centerNode = new THREE.Mesh(centerGeometry, centerMaterial);
                
                // 创建客户节点
                const clientsData = [
                    { name: "客户A", size: 0.6, color: 0xe74c3c, position: { x: 2.5, y: 1.5, z: 0 } },
                    { name: "客户B", size: 0.5, color: 0x2ecc71, position: { x: 2.5, y: -1.5, z: 0 } },
                    { name: "客户C", size: 0.4, color: 0xf39c12, position: { x: -2.5, y: 1.5, z: 0 } },
                    { name: "客户D", size: 0.3, color: 0x9b59b6, position: { x: -2.5, y: -1.5, z: 0 } }
                ];
                 
                const group = new THREE.Group();
                group.add(centerNode);
                
                // 添加客户节点
                clientsData.forEach(client => {
                    const clientGeometry = new THREE.SphereGeometry(client.size, 32, 32);
                    const clientMaterial = new THREE.MeshPhongMaterial({ color: client.color });
                    const clientNode = new THREE.Mesh(clientGeometry, clientMaterial);
                    clientNode.position.set(client.position.x, client.position.y, client.position.z);
                    
                    // 创建连接线
                    const lineMaterial = new THREE.LineBasicMaterial({ color: 0xffffff, opacity: 0.7, transparent: true });
                    const lineGeometry = new THREE.BufferGeometry().setFromPoints([
                        new THREE.Vector3(0, 0, 0),
                        new THREE.Vector3(client.position.x, client.position.y, client.position.z)
                    ]);
                    const line = new THREE.Line(lineGeometry, lineMaterial);
                    
                    group.add(clientNode);
                    group.add(line);
                });
                
                clientMesh = group;
                scene.add(clientMesh);
            }
            
            // 初始化未来战略3D可视化
            function initFutureStrategy() {
                const container = document.getElementById('future-strategy-canvas');
                if (!container) return;
                
                // 基本场景设置
                scene = new THREE.Scene();
                scene.background = new THREE.Color(0x1a1a1a);
                
                camera = new THREE.PerspectiveCamera(75, container.clientWidth / container.clientHeight, 0.1, 1000);
                camera.position.z = 5;
                
                renderer = new THREE.WebGLRenderer({
                    canvas: container,
                    antialias: true
                });
                renderer.setSize(container.clientWidth, container.clientHeight);
                
                // 添加灯光
                const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
                scene.add(ambientLight);
                
                const directionalLight = new THREE.DirectionalLight(0xffffff, 0.8);
                directionalLight.position.set(1, 1, 1);
                scene.add(directionalLight);
                
                // 创建未来战略路径可视化
                createFutureStrategyVisualization();
                
                // 隐藏加载文本
                document.getElementById('future-loading-text').style.display = 'none';
                
                // 开始动画
                animateThreeJs();
            }
            
            // 创建未来战略路径可视化
            function createFutureStrategyVisualization() {
                // 创建一条3D路径
                const curve = new THREE.CatmullRomCurve3([
                    new THREE.Vector3(-3, -2, 0),
                    new THREE.Vector3(-1, -1, 0),
                    new THREE.Vector3(0, 0, 0),
                    new THREE.Vector3(1, 1, 0),
                    new THREE.Vector3(3, 2, 0)
                ]);
                
                const points = curve.getPoints(50);
                const geometry = new THREE.BufferGeometry().setFromPoints(points);
                const material = new THREE.LineBasicMaterial({ color: 0x3498db, linewidth: 2 });
                const curveObject = new THREE.Line(geometry, material);
                
                // 创建路径上的里程碑节点
                const milestones = [
                    { position: new THREE.Vector3(-3, -2, 0), color: 0xe74c3c, size: 0.3 },
                    { position: new THREE.Vector3(-1, -1, 0), color: 0xf39c12, size: 0.3 },
                    { position: new THREE.Vector3(0, 0, 0), color: 0x2ecc71, size: 0.4 },
                    { position: new THREE.Vector3(1, 1, 0), color: 0x3498db, size: 0.3 },
                    { position: new THREE.Vector3(3, 2, 0), color: 0x9b59b6, size: 0.5 }
                ];
                
                const group = new THREE.Group();
                group.add(curveObject);
                
                milestones.forEach(milestone => {
                    const sphereGeometry = new THREE.SphereGeometry(milestone.size, 32, 32);
                    const sphereMaterial = new THREE.MeshPhongMaterial({ color: milestone.color });
                    const sphere = new THREE.Mesh(sphereGeometry, sphereMaterial);
                    sphere.position.copy(milestone.position);
                    group.add(sphere);
                });
                
                futureMesh = group;
                scene.add(futureMesh);
            }
            
            // Three.js动画循环
            function animateThreeJs() {
                if (!isThreeJsSlide) return;
                
                requestAnimationFrame(animateThreeJs);
                
                // 根据当前画布类型旋转不同的对象
                if (currentThreeJsCanvas === 'logo' && logoMesh) {
                    logoMesh.rotation.y += 0.01;
                } else if (currentThreeJsCanvas === 'market' && marketMesh) {
                    marketMesh.rotation.y += 0.01;
                } else if (currentThreeJsCanvas === 'client' && clientMesh) {
                    clientMesh.rotation.y += 0.005;
                } else if (currentThreeJsCanvas === 'future' && futureMesh) {
                    futureMesh.rotation.y += 0.005;
                }
                
                if (renderer && camera && scene) {
                    renderer.render(scene, camera);
                }
            }
            
            // 初始化业务结构饼图
            function initBusinessStructurePie() {
                const container = document.getElementById('business-structure-chart');
                if (!container) {
                    console.error('未找到业务结构饼图容器');
                    return;
                }
                
                try {
                    console.log('开始初始化业务结构饼图');
                    businessPieChart = echarts.init(container);
                    
                    const option = {
                        title: {
                            text: '2024年业务结构占比',
                            left: 'center',
                            textStyle: {
                                color: '#fff'
                            }
                        },
                        tooltip: {
                            trigger: 'item',
                            formatter: '{a} <br/>{b}: {c}%'
                        },
                        legend: {
                            orient: 'horizontal',
                            bottom: 10,
                            textStyle: {
                                color: '#fff'
                            }
                        },
                        series: [
                            {
                                name: '业务占比',
                                type: 'pie',
                                radius: '55%',
                                center: ['50%', '50%'],
                                data: goelData.businessStructure,
                                emphasis: {
                                    itemStyle: {
                                        shadowBlur: 10,
                                        shadowOffsetX: 0,
                                        shadowColor: 'rgba(0, 0, 0, 0.5)'
                                    }
                                },
                                label: {
                                    formatter: '{b}: {c}%'
                                },
                                color: ['#f9a825', '#66bb6a', '#42a5f5', '#ec407a']
                            }
                        ]
                    };
                    
                    businessPieChart.setOption(option);
                    console.log('业务结构饼图初始化完成');
                } catch (error) {
                    console.error('业务结构饼图初始化失败:', error);
                    container.innerHTML = '<div style="text-align:center;padding-top:100px;color:red;">图表加载失败</div>';
                }
            }
            
            // 初始化营收与利润趋势折线图
            function initRevenueProfitLine() {
                const container = document.getElementById('revenue-profit-chart');
                if (!container) return;
                
                try {
                    revenueProfitChart = echarts.init(container);
                    
                    const option = {
                        title: {
                            text: '营业收入与净利润十一年趋势(2014-2024)',
                            left: 'center',
                            textStyle: {
                                color: '#fff',
                                fontSize: 14  // 减小标题字体
                            },
                            className: 'echarts-title'
                        },
                        tooltip: {
                            trigger: 'axis',
                            axisPointer: {
                                type: 'cross'
                            }
                        },
                        legend: {
                            data: ['营业收入', '净利润'],
                            bottom: 10,
                            textStyle: {
                                color: '#fff',
                                fontSize: 12  // 减小图例字体
                            },
                            className: 'echarts-legend'
                        },
                        grid: {
                            left: '3%',
                            right: '8%',
                            bottom: '12%',
                            containLabel: true
                        },
                        xAxis: {
                            type: 'category',
                            boundaryGap: false,
                            data: goelData.revenue.years,
                            axisLabel: {
                                color: '#fff',
                                fontSize: 11  // 减小x轴标签字体
                            }
                        },
                        yAxis: [
                            {
                                type: 'value',
                                name: '营业收入(亿元)',
                                position: 'left',
                                max: 1100,
                                axisLabel: {
                                    formatter: '{value}',
                                    color: '#fff',
                                    fontSize: 11  // 减小y轴标签字体
                                },
                                splitLine: {
                                    lineStyle: {
                                        color: 'rgba(255,255,255,0.1)'
                                    }
                                },
                                axisLine: {
                                    lineStyle: {
                                        color: '#3498db'
                                    }
                                }
                            },
                            {
                                type: 'value',
                                name: '净利润(亿元)',
                                position: 'right',
                                max: 50,
                                axisLabel: {
                                    formatter: '{value}',
                                    color: '#fff',
                                    fontSize: 11  // 减小y轴标签字体
                                },
                                splitLine: {
                                    show: false
                                },
                                axisLine: {
                                    lineStyle: {
                                        color: '#2ecc71'
                                    }
                                }
                            }
                        ],
                        series: [
                            {
                                name: '营业收入',
                                type: 'line',
                                yAxisIndex: 0,
                                data: goelData.revenue.values,
                                smooth: true,
                                lineStyle: {
                                    width: 3,
                                    color: '#3498db'
                                },
                                itemStyle: {
                                    color: '#3498db'
                                },
                                markPoint: {
                                    data: [
                                        { type: 'max', name: '最大值' }
                                    ]
                                },
                                markArea: {
                                    itemStyle: {
                                        color: 'rgba(52, 152, 219, 0.2)'
                                    },
                                    data: [
                                        [{
                                            xAxis: '2021'
                                        }, {
                                            xAxis: '2022'
                                        }]
                                    ]
                                }
                            },
                            {
                                name: '净利润',
                                type: 'line',
                                yAxisIndex: 1,
                                data: goelData.profit.values,
                                smooth: true,
                                lineStyle: {
                                    width: 3,
                                    color: '#2ecc71'
                                },
                                itemStyle: {
                                    color: '#2ecc71'
                                },
                                markPoint: {
                                    data: [
                                        { type: 'max', name: '最大值' },
                                        { type: 'min', name: '最小值' }
                                    ]
                                },
                                markArea: {
                                    itemStyle: {
                                        color: 'rgba(46, 204, 113, 0.2)'
                                    },
                                    data: [
                                        [{
                                            xAxis: '2019'
                                        }, {
                                            xAxis: '2021'
                                        }]
                                    ]
                                }
                            }
                        ]
                    };
                    
                    revenueProfitChart.setOption(option);
                } catch (error) {
                    console.error('营收与利润趋势图初始化失败:', error);
                    container.innerHTML = '<div style="text-align:center;padding-top:100px;color:red;">图表加载失败</div>';
                }
            }
            
            // 初始化毛利率变化折线图
            function initGrossMarginLine() {
                const container = document.getElementById('gross-margin-chart');
                if (!container) return;
                
                try {
                    grossMarginChart = echarts.init(container);
                    
                    const option = {
                        title: {
                            text: '毛利率变化(2014-2024)',
                            left: 'center',
                            textStyle: {
                                color: '#fff'
                            }
                        },
                        tooltip: {
                            trigger: 'axis',
                            formatter: '{b}<br />{a0}: {c0}%'
                        },
                        legend: {
                            data: ['歌尔股份'],
                            bottom: 10,
                            textStyle: {
                                color: '#fff'
                            }
                        },
                        grid: {
                            left: '3%',
                            right: '4%',
                            bottom: '12%',
                            containLabel: true
                        },
                        xAxis: {
                            type: 'category',
                            data: goelData.grossMargin.years,
                            axisLabel: {
                                color: '#fff'
                            }
                        },
                        yAxis: {
                            type: 'value',
                            min: 0,
                            max: 30,
                            axisLabel: {
                                formatter: '{value}%',
                                color: '#fff'
                            },
                            splitLine: {
                                lineStyle: {
                                    color: 'rgba(255,255,255,0.1)'
                                }
                            }
                        },
                        series: [
                            {
                                name: '歌尔股份',
                                type: 'line',
                                data: goelData.grossMargin.goel,
                                smooth: true,
                                lineStyle: {
                                    width: 3,
                                    color: '#3498db'
                                },
                                itemStyle: {
                                    color: '#3498db'
                                },
                                markPoint: {
                                    data: [
                                        { type: 'max', name: '最大值' },
                                        { type: 'min', name: '最小值' }
                                    ]
                                },
                                markLine: {
                                    data: [
                                        {
                                            type: 'average',
                                            name: '平均值',
                                            lineStyle: {
                                                color: '#3498db',
                                                type: 'dashed'
                                            }
                                        }
                                    ]
                                }
                            }
                        ]
                    };
                    
                    grossMarginChart.setOption(option);
                } catch (error) {
                    console.error('毛利率变化图初始化失败:', error);
                    container.innerHTML = '<div style="text-align:center;padding-top:100px;color:red;">图表加载失败</div>';
                }
            }
            
            // 初始化ROE历年变化折线图
            function initRoeLine() {
                const container = document.getElementById('roe-chart');
                if (!container) return;
                
                try {
                    roeChart = echarts.init(container);
                    
                    const option = {
                        title: {
                            text: 'ROE历年变化(2014-2024)',
                            left: 'center',
                            textStyle: {
                                color: '#fff'
                            }
                        },
                        tooltip: {
                            trigger: 'axis',
                            formatter: '{b}<br />{a0}: {c0}%<br />{a1}: {c1}%'
                        },
                        legend: {
                            data: ['歌尔股份', '行业平均'],
                            bottom: 10,
                            textStyle: {
                                color: '#fff'
                            }
                        },
                        grid: {
                            left: '3%',
                            right: '4%',
                            bottom: '12%',
                            containLabel: true
                        },
                        xAxis: {
                            type: 'category',
                            data: goelData.roe.years,
                            axisLabel: {
                                color: '#fff'
                            }
                        },
                        yAxis: {
                            type: 'value',
                            min: 0,
                            max: 25,
                            axisLabel: {
                                formatter: '{value}%',
                                color: '#fff'
                            },
                            splitLine: {
                                lineStyle: {
                                    color: 'rgba(255,255,255,0.1)'
                                }
                            }
                        },
                        series: [
                            {
                                name: '歌尔股份',
                                type: 'line',
                                data: goelData.roe.goel,
                                smooth: true,
                                lineStyle: {
                                    width: 3,
                                    color: '#2ecc71'
                                },
                                itemStyle: {
                                    color: '#2ecc71'
                                },
                                markPoint: {
                                    data: [
                                        { type: 'max', name: '最大值' },
                                        { type: 'min', name: '最小值' }
                                    ]
                                },
                                markArea: {
                                    itemStyle: {
                                        color: 'rgba(46, 204, 113, 0.1)'
                                    },
                                    data: [
                                        [{
                                            xAxis: '2017'
                                        }, {
                                            xAxis: '2018'
                                        }],
                                        [{
                                            xAxis: '2019'
                                        }, {
                                            xAxis: '2020'
                                        }]
                                    ]
                                }
                            },
                            {
                                name: '行业平均',
                                type: 'line',
                                data: goelData.roe.industry,
                                smooth: true,
                                lineStyle: {
                                    width: 3,
                                    color: '#3498db',
                                    type: 'dashed'
                                },
                                itemStyle: {
                                    color: '#3498db'
                                }
                            }
                        ]
                    };
                    
                    roeChart.setOption(option);
                } catch (error) {
                    console.error('ROE变化图初始化失败:', error);
                    container.innerHTML = '<div style="text-align:center;padding-top:100px;color:red;">图表加载失败</div>';
                }
            }
            
            // 初始化GSAP动画
            function initGSAP(type) {
                console.log('初始化GSAP动画:', type);
                switch (type) {
                    case 'toc':
                        initTocAnimation();
                        break;
                    case 'manufacturing':
                        initManufacturingAnimation();
                        break;
                    case 'management':
                        initManagementTextAnimation();
                        break;
                    case 'industry-trend':
                        initIndustryTrendAnimation();
                        break;
                }
            }
            
            // 初始化目录动画
            function initTocAnimation() {
                const container = document.getElementById('toc-animation');
                if (!container) {
                    console.error('未找到目录动画容器');
                    return;
                }
                
                try {
                    console.log('开始初始化目录动画');
                    const elements = container.querySelectorAll('.gsap-timeline-element');
                    console.log('找到元素数量:', elements.length);
                    
                    // 设置初始状态为可见
                    gsap.set(elements, {
                        opacity: 1,
                        scale: 1,
                        x: 0
                    });
                    
                    // 创建悬停效果动画
                    elements.forEach(element => {
                        element.addEventListener('mouseenter', () => {
                            gsap.to(element, {
                                duration: 0.3,
                                scale: 1.1,
                                backgroundColor: "#00c6ff",
                                boxShadow: "0 0 20px rgba(0, 198, 255, 0.7)",
                                ease: "power2.out"
                            });
                        });
                        
                        element.addEventListener('mouseleave', () => {
                            gsap.to(element, {
                                duration: 0.3,
                                scale: 1,
                                backgroundColor: element.style.backgroundColor,
                                boxShadow: element.style.boxShadow,
                                ease: "power2.in"
                            });
                        });
                    });
                    
                    console.log('目录动画初始化完成');
                } catch (error) {
                    console.error('GSAP目录动画初始化失败:', error);
                }
            }
            
            // 初始化制造能力动画
            function initManufacturingAnimation() {
                const container = document.getElementById('manufacturing-animation');
                if (!container) return;
                
                try {
                    const boxes = container.querySelectorAll('.gsap-box');
                    
                    // 重置动画元素状态
                    gsap.set(boxes, {
                        scale: 0,
                        opacity: 0,
                        y: 50
                    });
                    
                    // 创建动画
                    manufacturingAnimation = gsap.timeline({repeat: -1, repeatDelay: 1})
                        .to(boxes, {
                            duration: 1, 
                            scale: 1, 
                            opacity: 1, 
                            y: 0, 
                            stagger: 0.2, 
                            ease: "back.out(1.7)"
                        })
                        .to(boxes, {
                            duration: 0.8, 
                            scale: 1.2, 
                            stagger: 0.2, 
                            ease: "power1.inOut",
                            yoyo: true,
                            repeat: 1
                        }, "+=0.5")
                        .to(boxes, {
                            duration: 0.8, 
                            scale: 0, 
                            opacity: 0, 
                            y: -50, 
                            stagger: 0.2, 
                            ease: "power1.in"
                        }, "+=1");
                } catch (error) {
                    console.error('制造能力动画初始化失败:', error);
                }
            }
            
            // 初始化管理团队文字动画
            function initManagementTextAnimation() {
                const container = document.getElementById('management-text');
                if (!container) return;
                
                try {
                    const texts = container.querySelectorAll('.gsap-text');
                    
                    // 设置文字状态为直接可见，无动画效果
                    gsap.set(texts, {
                        opacity: 1,
                        y: 0
                    });
                    
                    // 不创建动画时间线，直接显示文字
                    // 注释掉原有的动画代码
                    /*
                    managementTextAnimation = gsap.timeline({repeat: -1, repeatDelay: 1})
                        .to(texts[0], {duration: 1, opacity: 1, y: 0, ease: "back.out(1.7)"})
                        .to(texts[0], {duration: 1, opacity: 0, y: -50, ease: "power1.in", delay: 1.5})
                        .to(texts[1], {duration: 1, opacity: 1, y: 0, ease: "back.out(1.7)"})
                        .to(texts[1], {duration: 1, opacity: 0, y: -50, ease: "power1.in", delay: 1.5});
                    */
                    
                    // 创建空的时间线以保持变量一致性
                    managementTextAnimation = gsap.timeline();
                    
                } catch (error) {
                    console.error('管理团队文字动画初始化失败:', error);
                }
            }
            
            // 初始化行业趋势动画
            function initIndustryTrendAnimation() {
                const container = document.getElementById('industry-trend-stagger');
                if (!container) return;
                
                try {
                    const boxes = container.querySelectorAll('.gsap-stagger-box');
                    
                    // 设置颜色样式
                    boxes.forEach((box, index) => {
                        const colors = ['#3498db', '#2ecc71', '#e74c3c', '#f39c12', '#9b59b6', '#1abc9c', '#34495e', '#d35400', '#27ae60'];
                        box.style.backgroundColor = colors[index % colors.length];
                    });
                    
                    // 重置状态
                    gsap.set(boxes, {
                        opacity: 0,
                        scale: 0,
                        rotation: -180
                    });
                    
                    // 创建动画
                    industryTrendAnimation = gsap.timeline({repeat: -1, repeatDelay: 1})
                        .to(boxes, {
                            duration: 1, 
                            opacity: 1, 
                            scale: 1, 
                            rotation: 0,
                            stagger: {
                                each: 0.1,
                                from: "center",
                                grid: "auto"
                            },
                            ease: "elastic.out(1, 0.3)"
                        })
                        .to(boxes, {
                            duration: 0.8, 
                            scale: 1.2, 
                            stagger: {
                                each: 0.1,
                                from: "center",
                                grid: "auto"
                            },
                            ease: "power1.inOut",
                            yoyo: true,
                            repeat: 1
                        }, "+=1")
                        .to(boxes, {
                            duration: 0.8, 
                            opacity: 0, 
                            scale: 0, 
                            stagger: {
                                each: 0.05,
                                from: "edges",
                                grid: "auto"
                            },
                            ease: "power1.in",
                            delay: 1
                        });
                } catch (error) {
                    console.error('行业趋势动画初始化失败:', error);
                }
            }
            
            // 初始化客户集中度柱状图
            function initCustomerConcentrationBar() {
                const container = document.getElementById('customer-chart');
                if (!container) return;
                
                try {
                    customerChart = echarts.init(container);
                    
                    const option = {
                        title: {
                            text: '客户集中度分析(2024)',
                            left: 'center',
                            textStyle: {
                                color: '#fff'
                            },
                            subtext: '前两大客户合计占比超过70%',
                            subtextStyle: {
                                color: 'rgba(255,255,255,0.7)'
                            }
                        },
                        tooltip: {
                            trigger: 'axis',
                            axisPointer: {
                                type: 'shadow'
                            },
                            formatter: '{b}: {c}%'
                        },
                        grid: {
                            left: '3%',
                            right: '4%',
                            bottom: '10%',
                            containLabel: true
                        },
                        xAxis: {
                            type: 'category',
                            data: goelData.customerConcentration.names,
                            axisLabel: {
                                color: '#fff',
                                interval: 0,
                                rotate: 15
                            }
                        },
                        yAxis: {
                            type: 'value',
                            max: 50,
                            axisLabel: {
                                formatter: '{value}%',
                                color: '#fff'
                            },
                            splitLine: {
                                lineStyle: {
                                    color: 'rgba(255,255,255,0.1)'
                                }
                            }
                        },
                        series: [
                            {
                                name: '占比',
                                type: 'bar',
                                data: goelData.customerConcentration.values,
                                itemStyle: {
                                    color: function(params) {
                                        // 改变颜色以展示风险等级
                                        const colorList = ['#e74c3c', '#f39c12', '#f1c40f', '#3498db'];
                                        return colorList[params.dataIndex];
                                    }
                                },
                                label: {
                                    show: true,
                                    position: 'top',
                                    formatter: '{c}%',
                                    fontSize: 14,
                                    color: '#fff'
                                },
                                markLine: {
                                    silent: true,
                                    lineStyle: {
                                        color: '#e74c3c'
                                    },
                                    data: [{
                                        yAxis: 30,
                                        label: {
                                            formatter: '高风险警戒线',
                                            position: 'start'
                                        }
                                    }]
                                }
                            }
                        ]
                    };
                    
                    customerChart.setOption(option);
                } catch (error) {
                    console.error('客户集中度图初始化失败:', error);
                    container.innerHTML = '<div style="text-align:center;padding-top:100px;color:red;">图表加载失败</div>';
                }
            }
            
            // 初始化研发投入柱状图
            function initRdInvestmentBar() {
                const container = document.getElementById('rd-investment-bar');
                if (!container) return;
                
                try {
                    rdInvestmentChart = echarts.init(container);
                    
                    const option = {
                        title: {
                            text: '研发投入变化趋势(2019-2024)',
                            left: 'center',
                            textStyle: {
                                color: '#fff'
                            }
                        },
                        tooltip: {
                            trigger: 'axis',
                            axisPointer: {
                                type: 'cross',
                                crossStyle: {
                                    color: '#999'
                                }
                            },
                            formatter: function(params) {
                                let year = params[0].name;
                                let amount = params[0].value;
                                let percentage = params[1].value;
                                return year + '<br/>' +
                                    '研发投入金额: ' + amount + '亿元<br/>' +
                                    '研发投入占比: ' + percentage + '%';
                            }
                        },
                        legend: {
                            data: ['研发投入金额', '研发投入占比'],
                            bottom: 10,
                            textStyle: {
                                color: '#fff'
                            }
                        },
                        grid: {
                            left: '3%',
                            right: '4%',
                            bottom: '12%',
                            containLabel: true
                        },
                        xAxis: [
                            {
                                type: 'category',
                                data: goelData.rdInvestment.years,
                                axisPointer: {
                                    type: 'shadow'
                                },
                                axisLabel: {
                                    color: '#fff'
                                }
                            }
                        ],
                        yAxis: [
                            {
                                type: 'value',
                                name: '金额(亿元)',
                                position: 'left',
                                min: 0,
                                max: 60,
                                axisLabel: {
                                    formatter: '{value}',
                                    color: '#fff'
                                },
                                splitLine: {
                                    lineStyle: {
                                        color: 'rgba(255,255,255,0.1)'
                                    }
                                }
                            },
                            {
                                type: 'value',
                                name: '占比(%)',
                                min: 0,
                                max: 10,
                                position: 'right',
                                axisLabel: {
                                    formatter: '{value}',
                                    color: '#fff'
                                },
                                splitLine: {
                                    show: false
                                }
                            }
                        ],
                        series: [
                            {
                                name: '研发投入金额',
                                type: 'bar',
                                data: goelData.rdInvestment.amount,
                                itemStyle: {
                                    color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                        {offset: 0, color: '#3498db'},
                                        {offset: 1, color: '#2980b9'}
                                    ])
                                },
                                label: {
                                    show: true,
                                    position: 'top',
                                    formatter: '{c}亿',
                                    color: '#fff'
                                }
                            },
                            {
                                name: '研发投入占比',
                                type: 'line',
                                yAxisIndex: 1,
                                data: goelData.rdInvestment.percentage,
                                lineStyle: {
                                    width: 3,
                                    color: '#e74c3c'
                                },
                                itemStyle: {
                                    color: '#e74c3c'
                                },
                                label: {
                                    show: true,
                                    position: 'top',
                                    formatter: '{c}%',
                                    color: '#fff'
                                }
                            }
                        ]
                    };
                    
                    rdInvestmentChart.setOption(option);
                } catch (error) {
                    console.error('研发投入图初始化失败:', error);
                    container.innerHTML = '<div style="text-align:center;padding-top:100px;color:red;">图表加载失败</div>';
                }
            }
            
            // 初始化客户风险分析图
            function initCustomerRiskAnalysis() {
                const container = document.getElementById('customer-risk-analysis');
                if (!container) return;
                
                try {
                    customerRiskChart = echarts.init(container);
                    
                    const option = {
                        title: {
                            text: '客户依赖度变化趋势(2019-2023)',
                            left: 'center',
                            textStyle: {
                                color: '#fff'
                            },
                            subtext: '高度依赖客户占比持续上升',
                            subtextStyle: {
                                color: 'rgba(255,255,255,0.7)'
                            }
                        },
                        tooltip: {
                            trigger: 'axis',
                            axisPointer: {
                                type: 'shadow'
                            },
                            formatter: function(params) {
                                let result = params[0].name + '<br/>';
                                let total = 0;
                                params.forEach(item => {
                                    result += item.seriesName + ': ' + item.value + '%<br/>';
                                    total += item.value;
                                });
                                result += '总计: ' + total + '%';
                                return result;
                            }
                        },
                        legend: {
                            data: goelData.customerRiskAnalysis.categories,
                            bottom: 10,
                            textStyle: {
                                color: '#fff'
                            }
                        },
                        grid: {
                            left: '3%',
                            right: '4%',
                            bottom: '12%',
                            containLabel: true
                        },
                        xAxis: {
                            type: 'category',
                            data: goelData.customerRiskAnalysis.years,
                            axisLabel: {
                                color: '#fff'
                            }
                        },
                        yAxis: {
                            type: 'value',
                            axisLabel: {
                                formatter: '{value}%',
                                color: '#fff'
                            },
                            splitLine: {
                                lineStyle: {
                                    color: 'rgba(255,255,255,0.1)'
                                }
                            }
                        },
                        series: [
                            {
                                name: goelData.customerRiskAnalysis.categories[0],
                                type: 'bar',
                                stack: '总量',
                                emphasis: {
                                    focus: 'series'
                                },
                                data: goelData.customerRiskAnalysis.data[0],
                                itemStyle: {
                                    color: '#e74c3c',
                                    borderRadius: [8, 8, 0, 0]
                                },
                                label: {
                                    show: true,
                                    position: 'inside',
                                    formatter: function(params) {
                                        return params.value > 30 ? params.value + '%' : '';
                                    },
                                    color: '#fff'
                                }
                            },
                            {
                                name: goelData.customerRiskAnalysis.categories[1],
                                type: 'bar',
                                stack: '总量',
                                emphasis: {
                                    focus: 'series'
                                },
                                data: goelData.customerRiskAnalysis.data[1],
                                itemStyle: {
                                    color: '#f39c12'
                                },
                                label: {
                                    show: true,
                                    position: 'inside',
                                    formatter: function(params) {
                                        return params.value > 15 ? params.value + '%' : '';
                                    },
                                    color: '#fff'
                                }
                            },
                            {
                                name: goelData.customerRiskAnalysis.categories[2],
                                type: 'bar',
                                stack: '总量',
                                emphasis: {
                                    focus: 'series'
                                },
                                data: goelData.customerRiskAnalysis.data[2],
                                itemStyle: {
                                    color: '#2ecc71'
                                },
                                label: {
                                    show: true,
                                    position: 'inside',
                                    formatter: function(params) {
                                        return params.value > 10 ? params.value + '%' : '';
                                    },
                                    color: '#fff'
                                }
                            }
                        ]
                    };
                    
                    customerRiskChart.setOption(option);
                } catch (error) {
                    console.error('客户风险分析图初始化失败:', error);
                    container.innerHTML = '<div style="text-align:center;padding-top:100px;color:red;">图表加载失败</div>';
                }
            }
            
            // 初始化毛利率下滑分析饼图
            function initMarginDeclineAnalysis() {
                const container = document.getElementById('margin-decline-analysis');
                if (!container) return;
                
                try {
                    marginDeclineChart = echarts.init(container);
                    
                    const option = {
                        title: {
                            text: '毛利率下滑因素分析',
                            left: 'center',
                            textStyle: {
                                color: '#fff'
                            },
                            subtext: '业务结构变化是主要因素',
                            subtextStyle: {
                                color: 'rgba(255,255,255,0.7)'
                            }
                        },
                        tooltip: {
                            trigger: 'item',
                            formatter: '{a} <br/>{b}: {c}% ({d}%)'
                        },
                        legend: {
                            orient: 'vertical',
                            right: 10,
                            top: 'center',
                            textStyle: {
                                color: '#fff'
                            },
                            formatter: function(name) {
                                const data = goelData.marginDeclineFactors.find(item => item.name === name);
                                if (data) {
                                    return `${name}: ${data.value}%`;
                                }
                                return name;
                            }
                        },
                        series: [
                            {
                                name: '影响因素',
                                type: 'pie',
                                radius: ['40%', '70%'],
                                center: ['40%', '50%'],
                                avoidLabelOverlap: false,
                                itemStyle: {
                                    borderRadius: 10,
                                    borderColor: '#121212',
                                    borderWidth: 2
                                },
                                label: {
                                    show: false,
                                    position: 'center'
                                },
                                emphasis: {
                                    label: {
                                        show: true,
                                        fontSize: 22,
                                        fontWeight: 'bold',
                                        formatter: '{b}\n{c}%',
                                        color: '#fff'
                                    }
                                },
                                labelLine: {
                                    show: false
                                },
                                data: goelData.marginDeclineFactors,
                                color: ['#e74c3c', '#f39c12', '#3498db', '#9b59b6', '#1abc9c']
                            }
                        ]
                    };
                    
                    marginDeclineChart.setOption(option);
                } catch (error) {
                    console.error('毛利率下滑分析图初始化失败:', error);
                    container.innerHTML = '<div style="text-align:center;padding-top:100px;color:red;">图表加载失败</div>';
                }
            }
            
            // 初始化业绩波动分析图
            function initPerformanceVolatility() {
                const container = document.getElementById('performance-volatility-chart');
                if (!container) return;
                
                try {
                    performanceVolatilityChart = echarts.init(container);
                    
                    const option = {
                        title: {
                            text: '业绩波动性分析 (2019=100)',
                            left: 'center',
                            textStyle: {
                                color: '#fff',
                                fontSize: 12  // 减小标题字体大小
                            },
                            subtext: '营收与利润波动性明显高于行业平均',
                            subtextStyle: {
                                color: 'rgba(255,255,255,0.7)',
                                fontSize: 10  // 减小副标题字体大小
                            }
                        },
                        tooltip: {
                            trigger: 'axis',
                            axisPointer: {
                                type: 'cross'
                            },
                            formatter: function(params) {
                                let result = params[0].name + '<br/>';
                                params.forEach(item => {
                                    if (item.seriesName === '营业收入') {
                                        const growthRate = goelData.growthRate.revenue[goelData.performanceVolatility.years.indexOf(item.name)];
                                        result += `${item.marker}${item.seriesName}: ${item.value} (同比${growthRate >= 0 ? '+' : ''}${growthRate}%)<br/>`;
                                    } 
                                    else if (item.seriesName === '净利润') {
                                        const growthRate = goelData.growthRate.profit[goelData.performanceVolatility.years.indexOf(item.name)];
                                        result += `${item.marker}${item.seriesName}: ${item.value} (同比${growthRate >= 0 ? '+' : ''}${growthRate}%)<br/>`;
                                    }
                                    else {
                                        result += `${item.marker}${item.seriesName}: ${item.value}<br/>`;
                                    }
                                });
                                return result;
                            }
                        },
                        legend: {
                            data: ['营业收入', '净利润', '行业平均'],
                            bottom: 10,
                            textStyle: {
                                color: '#fff'
                            }
                        },
                        grid: {
                            left: '3%',
                            right: '4%',
                            bottom: '12%',
                            containLabel: true
                        },
                        xAxis: {
                            type: 'category',
                            data: goelData.performanceVolatility.years,
                            axisLabel: {
                                color: '#fff'
                            }
                        },
                        yAxis: {
                            type: 'value',
                            name: '指数(2019=100)',
                            min: 0,
                            max: 500,
                            axisLabel: {
                                color: '#fff'
                            },
                            splitLine: {
                                lineStyle: {
                                    color: 'rgba(255,255,255,0.1)'
                                }
                            }
                        },
                        series: [
                            {
                                name: '营业收入',
                                type: 'line',
                                data: goelData.performanceVolatility.revenue,
                                smooth: true,
                                lineStyle: {
                                    width: 3,
                                    color: '#3498db'
                                },
                                itemStyle: {
                                    color: '#3498db'
                                },
                                markPoint: {
                                    data: [
                                        { type: 'max', name: '最大值' },
                                        { type: 'min', name: '最小值' }
                                    ]
                                },
                                markArea: {
                                    itemStyle: {
                                        color: 'rgba(52, 152, 219, 0.2)'
                                    },
                                    data: [
                                        [{
                                            xAxis: '2021'
                                        }, {
                                            xAxis: '2022'
                                        }]
                                    ]
                                }
                            },
                            {
                                name: '净利润',
                                type: 'line',
                                data: goelData.performanceVolatility.profit,
                                smooth: true,
                                lineStyle: {
                                    width: 3,
                                    color: '#e74c3c'
                                },
                                itemStyle: {
                                    color: '#e74c3c'
                                },
                                markPoint: {
                                    data: [
                                        { type: 'max', name: '最大值' },
                                        { type: 'min', name: '最小值' }
                                    ]
                                },
                                markArea: {
                                    itemStyle: {
                                        color: 'rgba(231, 76, 60, 0.2)'
                                    },
                                    data: [
                                        [{
                                            xAxis: '2020'
                                        }, {
                                            xAxis: '2021'
                                        }]
                                    ]
                                }
                            },
                            {
                                name: '行业平均',
                                type: 'line',
                                data: goelData.performanceVolatility.industry,
                                smooth: true,
                                lineStyle: {
                                    width: 3,
                                    color: '#2ecc71',
                                    type: 'dashed'
                                },
                                itemStyle: {
                                    color: '#2ecc71'
                                },
                                areaStyle: {
                                    color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                        {
                                            offset: 0,
                                            color: 'rgba(46, 204, 113, 0.3)'
                                        },
                                        {
                                            offset: 1,
                                            color: 'rgba(46, 204, 113, 0)'
                                        }
                                    ])
                                }
                            }
                        ]
                    };
                    
                    performanceVolatilityChart.setOption(option);
                } catch (error) {
                    console.error('业绩波动分析图初始化失败:', error);
                    container.innerHTML = '<div style="text-align:center;padding-top:100px;color:red;">图表加载失败</div>';
                }
            }
            
            // 初始化未来预测图表
            function initFutureForecast() {
                const container = document.getElementById('future-forecast-chart');
                if (!container) return;
                
                try {
                    futureChart = echarts.init(container);
                    
                    // 计算同比变化率
                    const revenueChange = ((goelData.forecast2025.revenue - goelData.revenue.values[10]) / goelData.revenue.values[10] * 100).toFixed(2);
                    const profitChange = ((goelData.forecast2025.profit - goelData.profit.values[10]) / goelData.profit.values[10] * 100).toFixed(2);
                    const marginChange = (goelData.forecast2025.grossMargin - goelData.grossMargin.goel[10]).toFixed(2);
                    const roeChange = (goelData.forecast2025.roe - goelData.roe.goel[10]).toFixed(2);
                    
                    const option = {
                        title: {
                            text: '2025年预期指标',
                            left: 'center',
                            textStyle: {
                                color: '#fff'
                            },
                            subtext: '营收预计突破1200亿元',
                            subtextStyle: {
                                color: 'rgba(255,255,255,0.7)'
                            }
                        },
                        tooltip: {
                            trigger: 'axis',
                            axisPointer: {
                                type: 'shadow'
                            },
                            formatter: function(params) {
                                const indicator = params[0].name;
                                let year2024 = params[0].value;
                                let year2025 = params[1].value;
                                let result = indicator + '<br/>';
                                
                                result += params[0].marker + '2024年: ' + year2024 + '<br/>';
                                result += params[1].marker + '2025年(预测): ' + year2025 + '<br/>';
                                
                                // 添加同比变化
                                let change;
                                let changeText;
                                
                                if (indicator === '营业收入(亿元)') {
                                    change = revenueChange;
                                    changeText = change >= 0 ? `+${change}%` : `${change}%`;
                                } else if (indicator === '净利润(亿元)') {
                                    change = profitChange;
                                    changeText = change >= 0 ? `+${change}%` : `${change}%`;
                                } else if (indicator === '毛利率(%)') {
                                    change = marginChange;
                                    changeText = change >= 0 ? `+${change}个百分点` : `${change}个百分点`;
                                } else if (indicator === 'ROE(%)') {
                                    change = roeChange;
                                    changeText = change >= 0 ? `+${change}个百分点` : `${change}个百分点`;
                                }
                                
                                result += '同比变化: ' + changeText;
                                return result;
                            }
                        },
                        legend: {
                            data: ['2024年', '2025年(预测)'],
                            bottom: 10,
                            textStyle: {
                                color: '#fff'
                            }
                        },
                        grid: {
                            left: '3%',
                            right: '4%',
                            bottom: '20%',
                            top: '20%',
                            containLabel: true
                        },
                        xAxis: {
                            type: 'category',
                            data: ['营业收入(亿元)', '净利润(亿元)', '毛利率(%)', 'ROE(%)'],
                            axisLine: {
                                lineStyle: {
                                    color: '#fff'
                                }
                            },
                            axisLabel: {
                                color: '#fff',
                                interval: 0,
                                rotate: 0 // 不旋转标签
                            }
                        },
                        yAxis: {
                            type: 'value',
                            axisLine: {
                                lineStyle: {
                                    color: '#fff'
                                }
                            },
                            splitLine: {
                                lineStyle: {
                                    color: 'rgba(255,255,255,0.1)'
                                }
                            },
                            axisLabel: {
                                color: '#fff'
                            }
                        },
                        series: [
                            {
                                name: '2024年',
                                type: 'bar',
                                data: [
                                    goelData.revenue.values[10], 
                                    goelData.profit.values[10], 
                                    goelData.grossMargin.goel[10], 
                                    goelData.roe.goel[10]
                                ],
                                itemStyle: {
                                    color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                        {offset: 0, color: '#3498db'},
                                        {offset: 1, color: '#2980b9'}
                                    ])
                                },
                                label: {
                                    show: true,
                                    position: 'top',
                                    color: '#fff'
                                }
                            },
                            {
                                name: '2025年(预测)',
                                type: 'bar',
                                data: [
                                    goelData.forecast2025.revenue, 
                                    goelData.forecast2025.profit, 
                                    goelData.forecast2025.grossMargin, 
                                    goelData.forecast2025.roe
                                ],
                                itemStyle: {
                                    color: new echarts.graphic.LinearGradient(0, 0, 0, 1, [
                                        {offset: 0, color: '#2ecc71'},
                                        {offset: 1, color: '#27ae60'}
                                    ])
                                },
                                label: {
                                    show: true,
                                    position: 'top',
                                    formatter: function(params) {
                                        // 添加变化指示符
                                        let value = params.value;
                                        let indicator = '';
                                        
                                        if (params.name === '营业收入(亿元)') {
                                            indicator = revenueChange >= 0 ? '↑' : '↓';
                                        } else if (params.name === '净利润(亿元)') {
                                            indicator = profitChange >= 0 ? '↑' : '↓';
                                        } else if (params.name === '毛利率(%)') {
                                            indicator = marginChange >= 0 ? '↑' : '↓';
                                        } else if (params.name === 'ROE(%)') {
                                            indicator = roeChange >= 0 ? '↑' : '↓';
                                        }
                                        
                                        return value + ' ' + indicator;
                                    },
                                    color: '#fff'
                                }
                            }
                        ]
                    };
                    
                    futureChart.setOption(option);
                } catch (error) {
                    console.error('未来预测图初始化失败:', error);
                    container.innerHTML = '<div style="text-align:center;padding-top:100px;color:red;">图表加载失败</div>';
                }
            }

            function initBusinessStructurePieChart() {
                const chartDom = document.getElementById('business-structure-chart');
                if (!chartDom) return;
                
                const myChart = echarts.init(chartDom);
                
                const option = {
                    title: {
                        text: '业务结构分析',
                        left: 'center',
                        textStyle: {
                            color: '#fff',
                            fontSize: 16
                        }
                    },
                    tooltip: {
                        trigger: 'item',
                        formatter: '{a} <br/>{b}: {c}% ({d}%)'
                    },
                    legend: {
                        orient: 'vertical',
                        left: 'left',
                        textStyle: {
                            color: '#fff'
                        },
                        formatter: function(name) {
                            // 找到对应的数据
                            const data = goelData.businessStructure.find(item => item.name === name);
                            if (data) {
                                return `${name}: ${data.value.toFixed(2)}%`;
                            }
                            return name;
                        }
                    },
                    series: [
                        {
                            name: '业务占比',
                            type: 'pie',
                            radius: ['40%', '70%'],
                            avoidLabelOverlap: false,
                            itemStyle: {
                                borderRadius: 10,
                                borderColor: '#121212',
                                borderWidth: 2
                            },
                            label: {
                                show: true,
                                position: 'outside',
                                formatter: '{b}: {c}%',
                                color: '#fff'
                            },
                            emphasis: {
                                label: {
                                    show: true,
                                    fontSize: 16,
                                    fontWeight: 'bold'
                                }
                            },
                            labelLine: {
                                show: true
                            },
                            data: goelData.businessStructure,
                            color: ['#f9a825', '#66bb6a', '#42a5f5', '#ec407a']
                        }
                    ]
                };

                myChart.setOption(option);
                
                // 保存图表实例以便在窗口调整大小时重绘
                window.addEventListener('resize', function() {
                    myChart.resize();
                });
            }

            // 初始化竞争对手对比雷达图
            function initCompetitorsRadarChart() {
                try {
                    console.log('开始初始化竞争对手雷达图');
                    const container = document.getElementById('competitors-radar-chart');
                    if (!container) {
                        console.error('未找到竞争对手雷达图容器');
                        return;
                    }

                    // 确保容器尺寸
                    container.style.height = '600px';
                    container.style.width = '100%';

                    // 如果已存在实例，先销毁
                    if (competitorsRadarChart) {
                        competitorsRadarChart.dispose();
                    }
                    
                    // 创建新实例
                    competitorsRadarChart = echarts.init(container);
                    console.log('雷达图实例创建成功');
                    
                    const option = {
                        title: {
                            text: '行业竞争对手关键指标分析',
                            left: 'center',
                            top: 20,
                            textStyle: {
                                color: '#fff',
                                fontSize: 16
                            }
                        },
                        tooltip: {
                            trigger: 'item',
                            backgroundColor: 'rgba(0,0,0,0.7)',
                            borderColor: '#fff',
                            textStyle: {
                                color: '#fff'
                            }
                        },
                        legend: {
                            data: ['歌尔股份', '立讯精密', '舜宇光学'],
                            bottom: 20,
                            textStyle: {
                                color: '#fff',
                                fontSize: 12
                            }
                        },
                        radar: {
                            shape: 'circle',
                            splitNumber: 5,
                            center: ['50%', '50%'],
                            radius: '60%',
                            nameGap: 15,
                            axisLine: {
                                lineStyle: {
                                    color: 'rgba(255, 255, 255, 0.2)'
                                }
                            },
                            splitLine: {
                                lineStyle: {
                                    color: 'rgba(255, 255, 255, 0.2)'
                                }
                            },
                            splitArea: {
                                areaStyle: {
                                    color: ['rgba(255,255,255,0.02)', 'rgba(255,255,255,0.05)',
                                        'rgba(255,255,255,0.08)', 'rgba(255,255,255,0.1)',
                                        'rgba(255,255,255,0.12)']
                                }
                            },
                            indicator: [
                                { name: '营收规模(亿元)', max: 2000, color: '#fff' },
                                { name: '净利润(亿元)', max: 70, color: '#fff' },
                                { name: '毛利率(%)', max: 30, color: '#fff' },
                                { name: '市盈率(倍)', max: 80, color: '#fff' },
                                { name: '市净率(倍)', max: 5, color: '#fff' }
                            ],
                            name: {
                                textStyle: {
                                    color: '#fff',
                                    fontSize: 12,
                                    backgroundColor: 'transparent',
                                    padding: [3, 5]
                                }
                            }
                        },
                        series: [{
                            type: 'radar',
                            data: [
                                {
                                    value: [985.74, 10.88, 8.93, 72.0, 2.53],
                                    name: '歌尔股份',
                                    symbol: 'circle',
                                    symbolSize: 8,
                                    lineStyle: {
                                        width: 2,
                                        color: '#e74c3c'
                                    },
                                    areaStyle: {
                                        color: 'rgba(231, 76, 60, 0.2)'
                                    },
                                    itemStyle: {
                                        color: '#e74c3c'
                                    },
                                    emphasis: {
                                        lineStyle: {
                                            width: 4
                                        }
                                    }
                                },
                                {
                                    value: [1894.87, 66.34, 13.06, 28.5, 3.84],
                                    name: '立讯精密',
                                    symbol: 'circle',
                                    symbolSize: 8,
                                    lineStyle: {
                                        width: 2,
                                        color: '#f39c12'
                                    },
                                    areaStyle: {
                                        color: 'rgba(243, 156, 18, 0.2)'
                                    },
                                    itemStyle: {
                                        color: '#f39c12'
                                    },
                                    emphasis: {
                                        lineStyle: {
                                            width: 4
                                        }
                                    }
                                },
                                {
                                    value: [267.45, 15.6, 19.8, 36.2, 2.62],
                                    name: '舜宇光学',
                                    symbol: 'circle',
                                    symbolSize: 8,
                                    lineStyle: {
                                        width: 2,
                                        color: '#2ecc71'
                                    },
                                    areaStyle: {
                                        color: 'rgba(46, 204, 113, 0.2)'
                                    },
                                    itemStyle: {
                                        color: '#2ecc71'
                                    },
                                    emphasis: {
                                        lineStyle: {
                                            width: 4
                                        }
                                    }
                                }
                            ]
                        }]
                    };
                    
                    competitorsRadarChart.setOption(option);
                    console.log('雷达图配置完成');

                    // 添加窗口大小改变时的自动调整
                    window.addEventListener('resize', function() {
                        if (competitorsRadarChart) {
                            competitorsRadarChart.resize();
                        }
                    });

                } catch (error) {
                    console.error('竞争对手雷达图初始化失败:', error);
                    container.innerHTML = '<div style="text-align:center;padding-top:100px;color:red;">图表加载失败，请刷新页面重试</div>';
                }
            }

            // 在Reveal.js的slidechanged事件中添加图表初始化
            Reveal.on('slidechanged', function(event) {
                // 检查当前幻灯片是否包含竞争对手雷达图
                if (event.currentSlide.querySelector('#competitors-radar-chart')) {
                    console.log('检测到竞争对手雷达图页面，开始初始化');
                    // 延迟一点时间确保DOM已经完全准备好
                    setTimeout(initCompetitorsRadarChart, 100);
                }
            });

            // 初始化成本结构饼图
            function initCostStructurePie() {
                const container = document.getElementById('cost-structure-pie');
                if (!container) return;
                
                try {
                    costStructureChart = echarts.init(container);
                    
                    const option = {
                        title: {
                            text: '2024年成本结构分析',
                            left: 'center',
                            textStyle: {
                                color: '#fff'
                            }
                        },
                        tooltip: {
                            trigger: 'item',
                            formatter: '{a} <br/>{b}: {c}%'
                        },
                        legend: {
                            orient: 'vertical',
                            left: 10,
                            top: 'center',
                            itemWidth: 10, // 减小图例项宽度
                            itemHeight: 10, // 减小图例项高度
                            textStyle: {
                                color: '#eee',
                                fontSize: 11 // 减小图例字体
                            }
                        },
                        series: [
                            {
                                name: '成本占比',
                                type: 'pie',
                                radius: ['40%', '70%'], // 改为环形图
                                center: ['50%', '50%'],
                                avoidLabelOverlap: false,
                                label: {
                                    show: true,
                                    position: 'outside',
                                    formatter: '{b}: {c}%',
                                    color: '#fff'
                                },
                                emphasis: {
                                    itemStyle: {
                                        shadowBlur: 10,
                                        shadowOffsetX: 0,
                                        shadowColor: 'rgba(0, 0, 0, 0.5)'
                                    }
                                },
                                labelLine: {
                                    show: true
                                },
                                data: goelData.costStructure,
                                color: ['#e74c3c', '#9b59b6', '#3498db'],
                                itemStyle: {
                                    borderRadius: 10,
                                    borderColor: '#121212',
                                    borderWidth: 2
                                }
                            }
                        ],
                        animation: true,
                        animationDuration: 2500,  // 增加动画时长到2.5秒
                        animationEasing: 'elasticOut',  // 使用弹性缓出效果，更平滑
                        animationDelay: function(idx) {
                            return idx * 200;  // 为不同的数据项设置递增的延迟
                        },
                        animationThreshold: 10000  // 提高动画元素阈值，确保所有元素都有动画
                    };
                    
                    costStructureChart.setOption(option);
                } catch (error) {
                    console.error('成本结构饼图初始化失败:', error);
                    container.innerHTML = '<div style="text-align:center;padding-top:100px;color:red;">图表加载失败</div>';
                }
            }

            // 初始化股东结构分析饼图
            function initShareholderStructurePie() {
                try {
                    const container = document.getElementById('shareholder-structure-chart');
                    if (!container) {
                        console.error('找不到股东结构图容器: shareholder-structure-chart');
                        return;
                    }
                    
                    console.log('正在初始化股东结构饼图...');
                    shareholderStructurePieChart = echarts.init(container);
                    
                    const option = {
                        title: {
                            text: '股东结构分布',
                            left: 'center',
                            top: 5, // 减小顶部空间
                            textStyle: {
                                color: '#eee',
                                fontSize: 14 // 减小标题字体
                            }
                        },
                        tooltip: {
                            trigger: 'item',
                            formatter: '{a} <br/>{b}: {c} ({d}%)'
                        },
                        legend: {
                            orient: 'vertical',
                            left: 10,
                            top: 'center',
                            itemWidth: 10, // 减小图例项宽度
                            itemHeight: 10, // 减小图例项高度
                            textStyle: {
                                color: '#eee',
                                fontSize: 11 // 减小图例字体
                            },
                            data: goelData.shareholderStructure.names
                        },
                        series: [
                            {
                                name: '持股比例',
                                type: 'pie',
                                radius: ['40%', '60%'], // 减小饼图半径
                                center: ['50%', '45%'], // 将饼图稍微上移
                                avoidLabelOverlap: false,
                                label: {
                                    show: false,
                                    position: 'center'
                                },
                                emphasis: {
                                    label: {
                                        show: true,
                                        fontSize: '16', // 减小强调时的字体
                                        fontWeight: 'bold'
                                    }
                                },
                                labelLine: {
                                    show: false
                                },
                                data: goelData.shareholderStructure.names.map((name, index) => {
                                    return {
                                        name: name,
                                        value: goelData.shareholderStructure.values[index]
                                    };
                                })
                            }
                        ],
                        color: ['#f39c12', '#e74c3c', '#3498db', '#2ecc71', '#9b59b6', '#1abc9c', '#34495e', '#fd79a8']
                    };
                    
                    shareholderStructurePieChart.setOption(option);
                    currentEChartsType = 'shareholder-structure';
                    console.log('股东结构饼图初始化成功');
                    
                } catch (error) {
                    console.error('初始化股东结构饼图失败:', error);
                    if (document.getElementById('shareholder-structure-chart')) {
                        document.getElementById('shareholder-structure-chart').innerHTML = '<div class="chart-error">图表加载失败</div>';
                    }
                }
            }

            // 初始化股权集中度条形图
            function initShareholderConcentrationBar() {
                try {
                    const container = document.getElementById('shareholder-concentration-chart');
                    if (!container) {
                        console.error('找不到股权集中度图容器: shareholder-concentration-chart');
                        return;
                    }
                    
                    console.log('正在初始化股权集中度条形图...');
                    shareholderConcentrationBarChart = echarts.init(container);
                    
                    const option = {
                        title: {
                            text: '主要股东持股比例',
                            left: 'center',
                            top: 5, // 减小顶部空间
                            textStyle: {
                                color: '#eee',
                                fontSize: 14 // 减小标题字体
                            }
                        },
                        tooltip: {
                            trigger: 'axis',
                            axisPointer: {
                                type: 'shadow'
                            }
                        },
                        grid: {
                            left: '3%',
                            right: '4%',
                            bottom: '5%', // 减小底部空间
                            top: '15%', // 减小顶部空间
                            containLabel: true
                        },
                        xAxis: {
                            type: 'category',
                            data: goelData.shareholderStructure.names,
                            axisLabel: {
                                color: '#eee',
                                fontSize: 10 // 减小轴标签字体
                            }
                        },
                        yAxis: {
                            type: 'value',
                            name: '持股比例 (%)',
                            max: 70, // 调整最大值以减小纵向空间
                            axisLabel: {
                                color: '#eee',
                                formatter: '{value}%',
                                fontSize: 10 // 减小轴标签字体
                            }
                        },
                        series: [
                            {
                                name: '持股比例',
                                type: 'bar',
                                data: goelData.shareholderStructure.values,
                                itemStyle: {
                                    color: function(params) {
                                        const colorList = [
                                            '#f39c12',  // 户健
                                            '#e74c3c',  // 姜滨
                                            '#3498db',  // 高瓴
                                            '#2ecc71',  // 其他机构
                                            '#9b59b6'   // 其他个人
                                        ];
                                        return colorList[params.dataIndex % colorList.length];
                                    }
                                },
                                label: {
                                    show: true,
                                    position: 'top',
                                    formatter: '{c}%',
                                    fontSize: 10 // 减小标签字体
                                }
                            }
                        ]
                    };
                    
                    shareholderConcentrationBarChart.setOption(option);
                    currentEChartsType = 'shareholder-concentration';
                    console.log('股权集中度条形图初始化成功');
                    
                } catch (error) {
                    console.error('初始化股权集中度条形图失败:', error);
                    if (document.getElementById('shareholder-concentration-chart')) {
                        document.getElementById('shareholder-concentration-chart').innerHTML = '<div class="chart-error">图表加载失败</div>';
                    }
                }
            }

            // 初始化股价历年表现折线图
            function initStockPriceLine() {
                try {
                    const container = document.getElementById('stock-price-chart');
                    if (!container) {
                        console.error('找不到股价历年表现图容器: stock-price-chart');
                        return;
                    }
                    
                    console.log('正在初始化股价历年表现折线图...');
                    stockPriceLineChart = echarts.init(container);
                    
                    const option = {
                        title: {
                            text: '股价走势 (2014-2023)',
                            left: 'center',
                            top: 5, // 减小顶部空间
                            textStyle: {
                                color: '#eee',
                                fontSize: 14 // 减小标题字体
                            }
                        },
                        tooltip: {
                            trigger: 'axis',
                            axisPointer: {
                                type: 'cross',
                                label: {
                                    backgroundColor: '#6a7985'
                                }
                            }
                        },
                        legend: {
                            data: ['年末价格', '最高价', '最低价'],
                            textStyle: {
                                color: '#eee',
                                fontSize: 11 // 减小图例字体
                            },
                            itemWidth: 10, // 减小图例项宽度
                            itemHeight: 10, // 减小图例项高度
                            bottom: 0
                        },
                        grid: {
                            left: '3%',
                            right: '4%',
                            bottom: '15%',
                            top: '15%', // 减小顶部空间
                            containLabel: true
                        },
                        xAxis: {
                            type: 'category',
                            boundaryGap: false,
                            data: goelData.stockPrice.years,
                            axisLabel: {
                                color: '#eee',
                                fontSize: 10 // 减小轴标签字体
                            }
                        },
                        yAxis: {
                            type: 'value',
                            name: '股价 (元)',
                            axisLabel: {
                                color: '#eee',
                                formatter: '{value}元',
                                fontSize: 10 // 减小轴标签字体
                            }
                        },
                        series: [
                            {
                                name: '年末价格',
                                type: 'line',
                                data: goelData.stockPrice.yearEnd,
                                lineStyle: {
                                    width: 3,
                                    color: '#3498db'
                                },
                                symbol: 'circle',
                                symbolSize: 6, // 减小符号大小
                                markPoint: {
                                    data: [
                                        { type: 'max', name: '最大值' },
                                        { type: 'min', name: '最小值' }
                                    ],
                                    symbolSize: 40 // 减小标记点大小
                                }
                            },
                            {
                                name: '最高价',
                                type: 'line',
                                data: goelData.stockPrice.highest,
                                lineStyle: {
                                    width: 2,
                                    color: '#2ecc71',
                                    type: 'dashed'
                                },
                                symbol: 'circle',
                                symbolSize: 5 // 减小符号大小
                            },
                            {
                                name: '最低价',
                                type: 'line',
                                data: goelData.stockPrice.lowest,
                                lineStyle: {
                                    width: 2,
                                    color: '#e74c3c',
                                    type: 'dashed'
                                },
                                symbol: 'circle',
                                symbolSize: 5 // 减小符号大小
                            }
                        ]
                    };
                    
                    stockPriceLineChart.setOption(option);
                    currentEChartsType = 'stock-price';
                    console.log('股价历年表现折线图初始化成功');
                    
                } catch (error) {
                    console.error('初始化股价历年表现折线图失败:', error);
                    if (document.getElementById('stock-price-chart')) {
                        document.getElementById('stock-price-chart').innerHTML = '<div class="chart-error">图表加载失败</div>';
                    }
                }
            }

            // 初始化股价与业绩关联分析折线图
            function initStockPerformanceRelation() {
                try {
                    const container = document.getElementById('stock-performance-chart');
                    if (!container) {
                        console.error('找不到股价与业绩关联分析图容器: stock-performance-chart');
                        return;
                    }
                    
                    console.log('正在初始化股价与业绩关联分析折线图...');
                    stockPerformanceRelationChart = echarts.init(container);
                    
                    const option = {
                        title: {
                            text: '股价与业绩关联分析',
                            left: 'center',
                            top: 5, // 减小顶部空间
                            textStyle: {
                                color: '#eee',
                                fontSize: 14 // 减小标题字体
                            }
                        },
                        tooltip: {
                            trigger: 'axis',
                            axisPointer: {
                                type: 'cross'
                            }
                        },
                        legend: {
                            data: ['股价变化率', '营收增长率', '利润增长率'],
                            textStyle: {
                                color: '#eee',
                                fontSize: 11 // 减小图例字体
                            },
                            itemWidth: 10, // 减小图例项宽度
                            itemHeight: 10, // 减小图例项高度
                            bottom: 0
                        },
                        grid: {
                            left: '3%',
                            right: '4%',
                            bottom: '15%',
                            top: '15%', // 减小顶部空间
                            containLabel: true
                        },
                        xAxis: {
                            type: 'category',
                            boundaryGap: false,
                            data: goelData.stockPrice.years,
                            axisLabel: {
                                color: '#eee',
                                fontSize: 10 // 减小轴标签字体
                            }
                        },
                        yAxis: {
                            type: 'value',
                            name: '变化率 (%)',
                            axisLabel: {
                                color: '#eee',
                                formatter: '{value}%',
                                fontSize: 10 // 减小轴标签字体
                            }
                        },
                        series: [
                            {
                                name: '股价变化率',
                                type: 'line',
                                data: goelData.stockPrice.changeRate,
                                lineStyle: {
                                    width: 3,
                                    color: '#3498db'
                                },
                                symbol: 'circle',
                                symbolSize: 6 // 减小符号大小
                            },
                            {
                                name: '营收增长率',
                                type: 'line',
                                data: calculateGrowthRate(goelData.revenue.values),
                                lineStyle: {
                                    width: 2,
                                    color: '#2ecc71'
                                },
                                symbol: 'circle',
                                symbolSize: 5 // 减小符号大小
                            },
                            {
                                name: '利润增长率',
                                type: 'line',
                                data: calculateGrowthRate(goelData.profit.values),
                                lineStyle: {
                                    width: 2,
                                    color: '#e74c3c'
                                },
                                symbol: 'circle',
                                symbolSize: 5 // 减小符号大小
                            }
                        ]
                    };
                    
                    stockPerformanceRelationChart.setOption(option);
                    currentEChartsType = 'stock-performance';
                    console.log('股价与业绩关联分析折线图初始化成功');
                    
                } catch (error) {
                    console.error('初始化股价与业绩关联分析折线图失败:', error);
                    if (document.getElementById('stock-performance-chart')) {
                        document.getElementById('stock-performance-chart').innerHTML = '<div class="chart-error">图表加载失败</div>';
                    }
                }
            }

            // 计算增长率 - 辅助函数
            function calculateGrowthRate(data) {
                if (!Array.isArray(data)) {
                    console.error('calculateGrowthRate: 参数不是数组');
                    return [];
                }
                
                const growthRates = [];
                for (let i = 1; i < data.length; i++) {
                    const previous = data[i - 1];
                    const current = data[i];
                    if (previous && previous !== 0) {
                        const growthRate = ((current - previous) / Math.abs(previous)) * 100;
                        growthRates.push(parseFloat(growthRate.toFixed(2)));
                    } else {
                        growthRates.push(0);
                    }
                }
                // 为第一年添加0值或null，保持数组长度一致
                growthRates.unshift(null);
                return growthRates;
            }

            // 初始化市场估值指标分析条形图
            function initValuationIndicators() {
                try {
                    const container = document.getElementById('valuation-indicators-chart');
                    if (!container) {
                        console.error('找不到市场估值指标分析图容器: valuation-indicators-chart');
                        return;
                    }
                    
                    console.log('正在初始化市场估值指标分析条形图...');
                    valuationIndicatorsChart = echarts.init(container);
                    
                    const option = {
                        title: {
                            text: '市场估值指标分析',
                            left: 'center',
                            top: 5, // 减小顶部空间
                            textStyle: {
                                color: '#eee',
                                fontSize: 14 // 减小标题字体
                            }
                        },
                        tooltip: {
                            trigger: 'axis',
                            axisPointer: {
                                type: 'shadow'
                            }
                        },
                        legend: {
                            data: ['当前值', '预测值', '行业均值'],
                            textStyle: {
                                color: '#eee',
                                fontSize: 11 // 减小图例字体
                            },
                            itemWidth: 10, // 减小图例项宽度
                            itemHeight: 10, // 减小图例项高度
                            bottom: 0
                        },
                        grid: {
                            left: '3%',
                            right: '4%',
                            bottom: '25%', // 从15%增加到25%，给底部更多空间
                            top: '15%', // 已是最佳设置
                            containLabel: true
                        },
                        xAxis: {
                            type: 'category',
                            data: goelData.valuation.indicators,
                            axisLabel: {
                                color: '#eee',
                                fontSize: 10 // 减小轴标签字体
                            }
                        },
                        yAxis: {
                            type: 'value',
                            name: '数值',
                            axisLabel: {
                                color: '#eee',
                                fontSize: 10 // 减小轴标签字体
                            }
                        },
                        series: [
                            {
                                name: '当前值',
                                type: 'bar',
                                data: goelData.valuation.current,
                                itemStyle: {
                                    color: '#3498db'
                                },
                                label: {
                                    show: true,
                                    position: 'top',
                                    fontSize: 10 // 减小标签字体
                                }
                            },
                            {
                                name: '预测值',
                                type: 'bar',
                                data: goelData.valuation.forecast,
                                itemStyle: {
                                    color: '#2ecc71'
                                }
                            },
                            {
                                name: '行业均值',
                                type: 'bar',
                                data: goelData.valuation.industry,
                                itemStyle: {
                                    color: '#e74c3c'
                                }
                            }
                        ]
                    };
                    
                    valuationIndicatorsChart.setOption(option);
                    currentEChartsType = 'valuation-indicators';
                    console.log('市场估值指标分析条形图初始化成功');
                    
                } catch (error) {
                    console.error('初始化市场估值指标分析条形图失败:', error);
                    if (document.getElementById('valuation-indicators-chart')) {
                        document.getElementById('valuation-indicators-chart').innerHTML = '<div class="chart-error">图表加载失败</div>';
                    }
                }
            }

            // 初始化特定类型的ECharts图表
            function initECharts(type) {
                try {
                    console.log('初始化图表类型:', type);
                    
                    // 根据类型初始化相应的图表
                    switch(type) {
                        case 'business-structure':
                            initBusinessStructurePieChart();
                            break;
                        case 'revenue-profit':
                            initRevenueProfitChart();
                            break;
                        case 'gross-margin':
                            initGrossMarginChart();
                            break;
                        case 'roe':
                            initRoeChart();
                            break;
                        case 'customer-concentration':
                            initCustomerConcentrationChart();
                            break;
                        case 'rd-investment':
                            initRdInvestmentChart();
                            break;
                        case 'customer-risk':
                            initCustomerRiskAnalysis();
                            break;
                        case 'margin-decline':
                            initMarginDeclineAnalysis();
                            break;
                        case 'performance-volatility':
                            initPerformanceVolatility();
                            break;
                        case 'rd-efficiency':
                            initRdEfficiencyChart();
                            break;
                        default:
                            console.warn('未知的图表类型:', type);
                    }
                    
                    // 记录当前初始化的图表类型
                    currentEChartsType = type;
                } catch (e) {
                    console.error('初始化图表出错:', e);
                }
            }

            // 初始化研发投入效率图表
            function initRdEfficiencyChart() {
                const container = document.getElementById('rd-efficiency-chart');
                if (!container) return;
                
                try {
                    rdEfficiencyChart = echarts.init(container);
                    
                    const option = {
                        title: {
                            text: '研发投入效率分析',
                            left: 'center',
                            textStyle: {
                                color: '#fff',
                                fontSize: 14
                            }
                        },
                        tooltip: {
                            trigger: 'axis',
                            axisPointer: {
                                type: 'cross'
                            }
                        },
                        legend: {
                            data: ['研发投入占比', '研发人员数量', '专利申请量'],
                            bottom: 10,
                            textStyle: {
                                color: '#fff',
                                fontSize: 11
                            }
                        },
                        grid: {
                            left: '3%',
                            right: '4%',
                            bottom: '15%',
                            top: '15%',
                            containLabel: true
                        },
                        xAxis: {
                            type: 'category',
                            data: ['2019', '2020', '2021', '2022', '2023', '2024'],
                            axisLabel: {
                                color: '#fff',
                                fontSize: 10
                            }
                        },
                        yAxis: [
                            {
                                type: 'value',
                                name: '研发投入占比(%)',
                                position: 'left',
                                axisLabel: {
                                    formatter: '{value}%',
                                    color: '#fff',
                                    fontSize: 10
                                },
                                splitLine: {
                                    lineStyle: {
                                        color: 'rgba(255,255,255,0.1)'
                                    }
                                }
                            },
                            {
                                type: 'value',
                                name: '研发人员/专利数',
                                position: 'right',
                                axisLabel: {
                                    color: '#fff',
                                    fontSize: 10
                                },
                                splitLine: {
                                    show: false
                                }
                            }
                        ],
                        series: [
                            {
                                name: '研发投入占比',
                                type: 'line',
                                data: goelData.rdInvestment.percentage,
                                lineStyle: {
                                    width: 3,
                                    color: '#3498db'
                                },
                                itemStyle: {
                                    color: '#3498db'
                                },
                                label: {
                                    show: true,
                                    position: 'top',
                                    formatter: '{c}%',
                                    fontSize: 10,
                                    color: '#fff'
                                }
                            },
                            {
                                name: '研发人员数量',
                                type: 'bar',
                                yAxisIndex: 1,
                                data: [8000, 9500, 11000, 12000, 12300, 12500],
                                itemStyle: {
                                    color: '#2ecc71'
                                }
                            },
                            {
                                name: '专利申请量',
                                type: 'bar',
                                yAxisIndex: 1,
                                data: [2500, 3000, 3500, 4000, 4200, 4500],
                                itemStyle: {
                                    color: '#e74c3c'
                                }
                            }
                        ]
                    };
                    
                    rdEfficiencyChart.setOption(option);
                } catch (error) {
                    console.error('研发投入效率图表初始化失败:', error);
                    container.innerHTML = '<div style="text-align:center;padding-top:100px;color:red;">图表加载失败</div>';
                }
            }
		</script>

        <!-- 新增：标题页动画脚本 -->
        <script>
            // 初始化particles.js
            document.addEventListener('DOMContentLoaded', function() {
                particlesJS('particles-js', {
                    particles: {
                        number: {
                            value: 80,
                            density: {
                                enable: true,
                                value_area: 800
                            }
                        },
                        color: {
                            value: '#ffffff'
                        },
                        shape: {
                            type: 'circle'
                        },
                        opacity: {
                            value: 0.5,
                            random: true
                        },
                        size: {
                            value: 3,
                            random: true
                        },
                        line_linked: {
                            enable: true,
                            distance: 150,
                            color: '#ffffff',
                            opacity: 0.4,
                            width: 1
                        },
                        move: {
                            enable: true,
                            speed: 2,
                            direction: 'none',
                            random: true,
                            straight: false,
                            out_mode: 'out',
                            bounce: false
                        }
                    },
                    interactivity: {
                        detect_on: 'canvas',
                        events: {
                            onhover: {
                                enable: true,
                                mode: 'grab'
                            },
                            onclick: {
                                enable: true,
                                mode: 'push'
                            },
                            resize: true
                        }
                    },
                    retina_detect: true
                });
            });

            // 标题页动画
            Reveal.addEventListener('ready', function(event) {
                if (event.currentSlide.querySelector('.split-text')) {
                    // 分割标题文字
                    const title = event.currentSlide.querySelector('.split-text');
                    const text = title.textContent;
                    title.textContent = '';
                    
                    // 创建字符span
                    [...text].forEach(char => {
                        const span = document.createElement('span');
                        span.className = 'char';
                        span.textContent = char;
                        title.appendChild(span);
                    });

                    // 创建动画时间线
                        const tl = gsap.timeline({ 
                        delay: 0.5
                        });

                    // 标题容器动画
                    tl.to('.title-content', {
                            opacity: 1,
                        duration: 0.5
                    });

                    // 字符动画
                    tl.to('.char', {
                        opacity: 1,
                        y: 0,
                            duration: 0.8, 
                        stagger: 0.03,
                        ease: "back.out(1.7)"
                    });

                    // 作者信息动画
                    tl.to('.author-info', {
                            opacity: 1, 
                            y: 0, 
                        duration: 0.5,
                            ease: "power2.out" 
                    })
                    .to('.typing-text', {
                            opacity: 1, 
                        duration: 0.5
                    })
                    .to('.typing-cursor', {
                        opacity: 1,
                        duration: 0.3
                    });

                    // 背景脉冲动画
                    gsap.to('[data-background-gradient]::before', {
                        scale: 1.2,
                        opacity: 0.8,
                        duration: 4,
                        repeat: -1,
                        yoyo: true,
                            ease: "power1.inOut" 
                    });
                }
            });

            // 目录页动画
            Reveal.addEventListener('slidechanged', function(event) {
                // 检查是否是目录页
                const tocContainer = event.currentSlide.querySelector('.toc-container');
                if (tocContainer) {
                    // 获取所有目录项
                    const tocItems = tocContainer.querySelectorAll('.toc-item');
                    
                    // 创建动画时间线
                    const tl = gsap.timeline({
                        defaults: {
                            duration: 0.5,
                            ease: "power2.out"
                        }
                    });

                    // 为每个目录项添加动画
                    tocItems.forEach((item, index) => {
                        tl.fromTo(item, 
                            {
                                opacity: 0,
                                x: -100,
                                rotation: -10
                            },
                            {
                                opacity: 1,
                                x: 0,
                                rotation: 0,
                                duration: 0.6,
                                ease: "back.out(1.7)"
                            },
                            index * 0.15 // 错开每个项目的动画时间
                        );
                    });

                    // 添加鼠标悬停效果
                    tocItems.forEach(item => {
                        item.addEventListener('mouseenter', () => {
                            gsap.to(item, {
                                scale: 1.05,
                                boxShadow: "0 5px 15px rgba(0,0,0,0.3)",
                                duration: 0.3
                            });
                        });

                        item.addEventListener('mouseleave', () => {
                            gsap.to(item, {
                                scale: 1,
                                boxShadow: "none",
                                duration: 0.3
                            });
                        });

                        // 点击效果
                        item.addEventListener('click', () => {
                            gsap.to(item, {
                                scale: 0.95,
                                duration: 0.1,
                                yoyo: true,
                                repeat: 1
                            });
                        });
                    });
                }
            });
        </script>

        <!-- 添加强制初始化图表的脚本 -->
        <script>
            // 页面完全加载后执行
            window.addEventListener('load', function() {
                // 强制初始化竞争对手雷达图
                setTimeout(function() {
                    console.log('延迟2秒强制初始化竞争对手雷达图');
                    
                    // 获取容器并确保其尺寸
                    const competitorsContainer = document.getElementById('competitors-radar-chart');
                    if (competitorsContainer) {
                        // 确保容器有足够的高度和宽度
                        if (competitorsContainer.offsetHeight < 100) {
                            competitorsContainer.style.height = '480px';
                        }
                        if (competitorsContainer.offsetWidth < 100) {
                            competitorsContainer.style.width = '100%';
                        }
                        
                        // 强制初始化图表
                        try {
                            // 如果已经有图表实例，先销毁
                            if (window.competitorsRadarChart) {
                                window.competitorsRadarChart.dispose();
                            }
                            
                            // 重新初始化
                            initCompetitorsRadarChart();
                            console.log('竞争对手雷达图初始化成功');
                        } catch (error) {
                            console.error('强制初始化竞争对手雷达图失败:', error);
                            competitorsContainer.innerHTML = '<div style="text-align:center;padding-top:100px;color:red;">图表加载失败，请刷新页面重试</div>';
                        }
                    } else {
                        console.error('未找到竞争对手雷达图容器');
                    }
                }, 2000); // 延迟2秒执行，确保页面元素已完全加载
                
                // 为所有ECharts容器添加明确的最小高度样式
                const chartContainers = document.querySelectorAll('.echarts-container');
                chartContainers.forEach(function(container) {
                    if (container.offsetHeight < 100) {
                        container.style.minHeight = '400px';
                    }
                });
                
                // 为估值指标图表容器特别设置更大的高度
                const valuationContainer = document.getElementById('valuation-indicators-chart');
                if (valuationContainer) {
                    valuationContainer.style.minHeight = '500px'; // 设置更大的高度
                }
            });
        </script>
	</body>
</html> 
</html> 